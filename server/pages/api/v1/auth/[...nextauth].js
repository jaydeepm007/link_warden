"use strict";
(() => {
var exports = {};
exports.id = 874;
exports.ids = [874];
exports.modules = {

/***/ 3524:
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ 7096:
/***/ ((module) => {

module.exports = require("bcrypt");

/***/ }),

/***/ 2097:
/***/ ((module) => {

module.exports = require("handlebars");

/***/ }),

/***/ 2113:
/***/ ((module) => {

module.exports = require("next-auth/next");

/***/ }),

/***/ 5080:
/***/ ((module) => {

module.exports = require("next-auth/providers/42-school");

/***/ }),

/***/ 9488:
/***/ ((module) => {

module.exports = require("next-auth/providers/apple");

/***/ }),

/***/ 5319:
/***/ ((module) => {

module.exports = require("next-auth/providers/atlassian");

/***/ }),

/***/ 8598:
/***/ ((module) => {

module.exports = require("next-auth/providers/auth0");

/***/ }),

/***/ 7643:
/***/ ((module) => {

module.exports = require("next-auth/providers/authentik");

/***/ }),

/***/ 4315:
/***/ ((module) => {

module.exports = require("next-auth/providers/azure-ad");

/***/ }),

/***/ 9932:
/***/ ((module) => {

module.exports = require("next-auth/providers/azure-ad-b2c");

/***/ }),

/***/ 5606:
/***/ ((module) => {

module.exports = require("next-auth/providers/battlenet");

/***/ }),

/***/ 4649:
/***/ ((module) => {

module.exports = require("next-auth/providers/box");

/***/ }),

/***/ 4008:
/***/ ((module) => {

module.exports = require("next-auth/providers/cognito");

/***/ }),

/***/ 6956:
/***/ ((module) => {

module.exports = require("next-auth/providers/coinbase");

/***/ }),

/***/ 7449:
/***/ ((module) => {

module.exports = require("next-auth/providers/credentials");

/***/ }),

/***/ 9783:
/***/ ((module) => {

module.exports = require("next-auth/providers/discord");

/***/ }),

/***/ 8069:
/***/ ((module) => {

module.exports = require("next-auth/providers/dropbox");

/***/ }),

/***/ 758:
/***/ ((module) => {

module.exports = require("next-auth/providers/duende-identity-server6");

/***/ }),

/***/ 9673:
/***/ ((module) => {

module.exports = require("next-auth/providers/email");

/***/ }),

/***/ 4696:
/***/ ((module) => {

module.exports = require("next-auth/providers/eveonline");

/***/ }),

/***/ 6209:
/***/ ((module) => {

module.exports = require("next-auth/providers/facebook");

/***/ }),

/***/ 483:
/***/ ((module) => {

module.exports = require("next-auth/providers/faceit");

/***/ }),

/***/ 6074:
/***/ ((module) => {

module.exports = require("next-auth/providers/foursquare");

/***/ }),

/***/ 768:
/***/ ((module) => {

module.exports = require("next-auth/providers/freshbooks");

/***/ }),

/***/ 9586:
/***/ ((module) => {

module.exports = require("next-auth/providers/fusionauth");

/***/ }),

/***/ 7459:
/***/ ((module) => {

module.exports = require("next-auth/providers/github");

/***/ }),

/***/ 5072:
/***/ ((module) => {

module.exports = require("next-auth/providers/gitlab");

/***/ }),

/***/ 3598:
/***/ ((module) => {

module.exports = require("next-auth/providers/google");

/***/ }),

/***/ 1806:
/***/ ((module) => {

module.exports = require("next-auth/providers/hubspot");

/***/ }),

/***/ 4254:
/***/ ((module) => {

module.exports = require("next-auth/providers/identity-server4");

/***/ }),

/***/ 4854:
/***/ ((module) => {

module.exports = require("next-auth/providers/kakao");

/***/ }),

/***/ 4899:
/***/ ((module) => {

module.exports = require("next-auth/providers/keycloak");

/***/ }),

/***/ 5915:
/***/ ((module) => {

module.exports = require("next-auth/providers/line");

/***/ }),

/***/ 9800:
/***/ ((module) => {

module.exports = require("next-auth/providers/linkedin");

/***/ }),

/***/ 7124:
/***/ ((module) => {

module.exports = require("next-auth/providers/mailchimp");

/***/ }),

/***/ 12:
/***/ ((module) => {

module.exports = require("next-auth/providers/mailru");

/***/ }),

/***/ 6671:
/***/ ((module) => {

module.exports = require("next-auth/providers/naver");

/***/ }),

/***/ 4266:
/***/ ((module) => {

module.exports = require("next-auth/providers/netlify");

/***/ }),

/***/ 5654:
/***/ ((module) => {

module.exports = require("next-auth/providers/okta");

/***/ }),

/***/ 7830:
/***/ ((module) => {

module.exports = require("next-auth/providers/onelogin");

/***/ }),

/***/ 4893:
/***/ ((module) => {

module.exports = require("next-auth/providers/osso");

/***/ }),

/***/ 2591:
/***/ ((module) => {

module.exports = require("next-auth/providers/osu");

/***/ }),

/***/ 1681:
/***/ ((module) => {

module.exports = require("next-auth/providers/patreon");

/***/ }),

/***/ 3158:
/***/ ((module) => {

module.exports = require("next-auth/providers/pinterest");

/***/ }),

/***/ 1050:
/***/ ((module) => {

module.exports = require("next-auth/providers/pipedrive");

/***/ }),

/***/ 9852:
/***/ ((module) => {

module.exports = require("next-auth/providers/reddit");

/***/ }),

/***/ 7269:
/***/ ((module) => {

module.exports = require("next-auth/providers/salesforce");

/***/ }),

/***/ 8881:
/***/ ((module) => {

module.exports = require("next-auth/providers/slack");

/***/ }),

/***/ 2675:
/***/ ((module) => {

module.exports = require("next-auth/providers/spotify");

/***/ }),

/***/ 8718:
/***/ ((module) => {

module.exports = require("next-auth/providers/strava");

/***/ }),

/***/ 4125:
/***/ ((module) => {

module.exports = require("next-auth/providers/todoist");

/***/ }),

/***/ 8630:
/***/ ((module) => {

module.exports = require("next-auth/providers/twitch");

/***/ }),

/***/ 1141:
/***/ ((module) => {

module.exports = require("next-auth/providers/united-effects");

/***/ }),

/***/ 3979:
/***/ ((module) => {

module.exports = require("next-auth/providers/vk");

/***/ }),

/***/ 1818:
/***/ ((module) => {

module.exports = require("next-auth/providers/wikimedia");

/***/ }),

/***/ 9350:
/***/ ((module) => {

module.exports = require("next-auth/providers/wordpress");

/***/ }),

/***/ 4037:
/***/ ((module) => {

module.exports = require("next-auth/providers/yandex");

/***/ }),

/***/ 4835:
/***/ ((module) => {

module.exports = require("next-auth/providers/zitadel");

/***/ }),

/***/ 2624:
/***/ ((module) => {

module.exports = require("next-auth/providers/zoho");

/***/ }),

/***/ 3930:
/***/ ((module) => {

module.exports = require("next-auth/providers/zoom");

/***/ }),

/***/ 9369:
/***/ ((module) => {

module.exports = require("process");

/***/ }),

/***/ 3288:
/***/ ((module) => {

module.exports = import("@auth/prisma-adapter");;

/***/ }),

/***/ 6090:
/***/ ((module) => {

module.exports = import("stripe");;

/***/ }),

/***/ 7147:
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ 1017:
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ 67:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Z: () => (/* binding */ sendVerificationRequest)
/* harmony export */ });
/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(7147);
/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1017);
/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var handlebars__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2097);
/* harmony import */ var handlebars__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(handlebars__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _transporter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(4839);




async function sendVerificationRequest({ identifier, url, from, token }) {
    const emailsDir = path__WEBPACK_IMPORTED_MODULE_1___default().resolve(process.cwd(), "templates");
    const templateFile = (0,fs__WEBPACK_IMPORTED_MODULE_0__.readFileSync)(path__WEBPACK_IMPORTED_MODULE_1___default().join(emailsDir, "verifyEmail.html"), "utf8");
    const emailTemplate = handlebars__WEBPACK_IMPORTED_MODULE_2___default().compile(templateFile);
    const { host } = new URL(url);
    const result = await _transporter__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z.sendMail({
        to: identifier,
        from: {
            name: "Linkwarden",
            address: from
        },
        subject: `Please verify your email address`,
        text: text({
            url,
            host
        }),
        html: emailTemplate({
            url: `${process.env.NEXTAUTH_URL}/callback/email?token=${token}&email=${encodeURIComponent(identifier)}`
        })
    });
    const failed = result.rejected.concat(result.pending).filter(Boolean);
    if (failed.length) {
        throw new Error(`Email (${failed.join(", ")}) could not be sent`);
    }
}
/** Email Text body (fallback for email clients that don't render HTML, e.g. feature phones) */ function text({ url, host }) {
    return `Sign in to ${host}\n${url}\n\n`;
}


/***/ }),

/***/ 4839:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {


// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  Z: () => (/* binding */ transporter)
});

;// CONCATENATED MODULE: external "nodemailer"
const external_nodemailer_namespaceObject = require("nodemailer");
;// CONCATENATED MODULE: ./lib/api/transporter.ts

/* harmony default export */ const transporter = ((0,external_nodemailer_namespaceObject.createTransport)({
    url: process.env.EMAIL_SERVER,
    auth: {
        user: process.env.EMAIL_FROM
    }
}));


/***/ }),

/***/ 5349:
/***/ ((module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ auth)
/* harmony export */ });
/* harmony import */ var _lib_api_db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(3009);
/* harmony import */ var _lib_api_sendVerificationRequest__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(67);
/* harmony import */ var _lib_api_verifySubscription__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(5746);
/* harmony import */ var _auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(3288);
/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(7096);
/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(bcrypt__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var next_auth_next__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2113);
/* harmony import */ var next_auth_next__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_auth_next__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var next_auth_providers_42_school__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(5080);
/* harmony import */ var next_auth_providers_42_school__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_42_school__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var next_auth_providers_apple__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(9488);
/* harmony import */ var next_auth_providers_apple__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_apple__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var next_auth_providers_atlassian__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(5319);
/* harmony import */ var next_auth_providers_atlassian__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_atlassian__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var next_auth_providers_auth0__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(8598);
/* harmony import */ var next_auth_providers_auth0__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_auth0__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var next_auth_providers_authentik__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(7643);
/* harmony import */ var next_auth_providers_authentik__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_authentik__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var next_auth_providers_azure_ad__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(4315);
/* harmony import */ var next_auth_providers_azure_ad__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_azure_ad__WEBPACK_IMPORTED_MODULE_11__);
/* harmony import */ var next_auth_providers_azure_ad_b2c__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(9932);
/* harmony import */ var next_auth_providers_azure_ad_b2c__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_azure_ad_b2c__WEBPACK_IMPORTED_MODULE_12__);
/* harmony import */ var next_auth_providers_battlenet__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(5606);
/* harmony import */ var next_auth_providers_battlenet__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_battlenet__WEBPACK_IMPORTED_MODULE_13__);
/* harmony import */ var next_auth_providers_box__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(4649);
/* harmony import */ var next_auth_providers_box__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_box__WEBPACK_IMPORTED_MODULE_14__);
/* harmony import */ var next_auth_providers_cognito__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(4008);
/* harmony import */ var next_auth_providers_cognito__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_cognito__WEBPACK_IMPORTED_MODULE_15__);
/* harmony import */ var next_auth_providers_coinbase__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(6956);
/* harmony import */ var next_auth_providers_coinbase__WEBPACK_IMPORTED_MODULE_16___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_coinbase__WEBPACK_IMPORTED_MODULE_16__);
/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(7449);
/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_17___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_17__);
/* harmony import */ var next_auth_providers_discord__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(9783);
/* harmony import */ var next_auth_providers_discord__WEBPACK_IMPORTED_MODULE_18___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_discord__WEBPACK_IMPORTED_MODULE_18__);
/* harmony import */ var next_auth_providers_dropbox__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(8069);
/* harmony import */ var next_auth_providers_dropbox__WEBPACK_IMPORTED_MODULE_19___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_dropbox__WEBPACK_IMPORTED_MODULE_19__);
/* harmony import */ var next_auth_providers_duende_identity_server6__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(758);
/* harmony import */ var next_auth_providers_duende_identity_server6__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_duende_identity_server6__WEBPACK_IMPORTED_MODULE_20__);
/* harmony import */ var next_auth_providers_email__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(9673);
/* harmony import */ var next_auth_providers_email__WEBPACK_IMPORTED_MODULE_21___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_email__WEBPACK_IMPORTED_MODULE_21__);
/* harmony import */ var next_auth_providers_eveonline__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(4696);
/* harmony import */ var next_auth_providers_eveonline__WEBPACK_IMPORTED_MODULE_22___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_eveonline__WEBPACK_IMPORTED_MODULE_22__);
/* harmony import */ var next_auth_providers_facebook__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(6209);
/* harmony import */ var next_auth_providers_facebook__WEBPACK_IMPORTED_MODULE_23___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_facebook__WEBPACK_IMPORTED_MODULE_23__);
/* harmony import */ var next_auth_providers_faceit__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(483);
/* harmony import */ var next_auth_providers_faceit__WEBPACK_IMPORTED_MODULE_24___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_faceit__WEBPACK_IMPORTED_MODULE_24__);
/* harmony import */ var next_auth_providers_foursquare__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(6074);
/* harmony import */ var next_auth_providers_foursquare__WEBPACK_IMPORTED_MODULE_25___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_foursquare__WEBPACK_IMPORTED_MODULE_25__);
/* harmony import */ var next_auth_providers_freshbooks__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(768);
/* harmony import */ var next_auth_providers_freshbooks__WEBPACK_IMPORTED_MODULE_26___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_freshbooks__WEBPACK_IMPORTED_MODULE_26__);
/* harmony import */ var next_auth_providers_fusionauth__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(9586);
/* harmony import */ var next_auth_providers_fusionauth__WEBPACK_IMPORTED_MODULE_27___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_fusionauth__WEBPACK_IMPORTED_MODULE_27__);
/* harmony import */ var next_auth_providers_github__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(7459);
/* harmony import */ var next_auth_providers_github__WEBPACK_IMPORTED_MODULE_28___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_github__WEBPACK_IMPORTED_MODULE_28__);
/* harmony import */ var next_auth_providers_gitlab__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(5072);
/* harmony import */ var next_auth_providers_gitlab__WEBPACK_IMPORTED_MODULE_29___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_gitlab__WEBPACK_IMPORTED_MODULE_29__);
/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(3598);
/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_30___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_google__WEBPACK_IMPORTED_MODULE_30__);
/* harmony import */ var next_auth_providers_hubspot__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(1806);
/* harmony import */ var next_auth_providers_hubspot__WEBPACK_IMPORTED_MODULE_31___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_hubspot__WEBPACK_IMPORTED_MODULE_31__);
/* harmony import */ var next_auth_providers_identity_server4__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(4254);
/* harmony import */ var next_auth_providers_identity_server4__WEBPACK_IMPORTED_MODULE_32___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_identity_server4__WEBPACK_IMPORTED_MODULE_32__);
/* harmony import */ var next_auth_providers_kakao__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(4854);
/* harmony import */ var next_auth_providers_kakao__WEBPACK_IMPORTED_MODULE_33___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_kakao__WEBPACK_IMPORTED_MODULE_33__);
/* harmony import */ var next_auth_providers_keycloak__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(4899);
/* harmony import */ var next_auth_providers_keycloak__WEBPACK_IMPORTED_MODULE_34___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_keycloak__WEBPACK_IMPORTED_MODULE_34__);
/* harmony import */ var next_auth_providers_line__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(5915);
/* harmony import */ var next_auth_providers_line__WEBPACK_IMPORTED_MODULE_35___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_line__WEBPACK_IMPORTED_MODULE_35__);
/* harmony import */ var next_auth_providers_linkedin__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(9800);
/* harmony import */ var next_auth_providers_linkedin__WEBPACK_IMPORTED_MODULE_36___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_linkedin__WEBPACK_IMPORTED_MODULE_36__);
/* harmony import */ var next_auth_providers_mailchimp__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(7124);
/* harmony import */ var next_auth_providers_mailchimp__WEBPACK_IMPORTED_MODULE_37___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_mailchimp__WEBPACK_IMPORTED_MODULE_37__);
/* harmony import */ var next_auth_providers_mailru__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(12);
/* harmony import */ var next_auth_providers_mailru__WEBPACK_IMPORTED_MODULE_38___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_mailru__WEBPACK_IMPORTED_MODULE_38__);
/* harmony import */ var next_auth_providers_naver__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(6671);
/* harmony import */ var next_auth_providers_naver__WEBPACK_IMPORTED_MODULE_39___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_naver__WEBPACK_IMPORTED_MODULE_39__);
/* harmony import */ var next_auth_providers_netlify__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(4266);
/* harmony import */ var next_auth_providers_netlify__WEBPACK_IMPORTED_MODULE_40___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_netlify__WEBPACK_IMPORTED_MODULE_40__);
/* harmony import */ var next_auth_providers_okta__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(5654);
/* harmony import */ var next_auth_providers_okta__WEBPACK_IMPORTED_MODULE_41___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_okta__WEBPACK_IMPORTED_MODULE_41__);
/* harmony import */ var next_auth_providers_onelogin__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(7830);
/* harmony import */ var next_auth_providers_onelogin__WEBPACK_IMPORTED_MODULE_42___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_onelogin__WEBPACK_IMPORTED_MODULE_42__);
/* harmony import */ var next_auth_providers_osso__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(4893);
/* harmony import */ var next_auth_providers_osso__WEBPACK_IMPORTED_MODULE_43___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_osso__WEBPACK_IMPORTED_MODULE_43__);
/* harmony import */ var next_auth_providers_osu__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(2591);
/* harmony import */ var next_auth_providers_osu__WEBPACK_IMPORTED_MODULE_44___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_osu__WEBPACK_IMPORTED_MODULE_44__);
/* harmony import */ var next_auth_providers_patreon__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(1681);
/* harmony import */ var next_auth_providers_patreon__WEBPACK_IMPORTED_MODULE_45___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_patreon__WEBPACK_IMPORTED_MODULE_45__);
/* harmony import */ var next_auth_providers_pinterest__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(3158);
/* harmony import */ var next_auth_providers_pinterest__WEBPACK_IMPORTED_MODULE_46___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_pinterest__WEBPACK_IMPORTED_MODULE_46__);
/* harmony import */ var next_auth_providers_pipedrive__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(1050);
/* harmony import */ var next_auth_providers_pipedrive__WEBPACK_IMPORTED_MODULE_47___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_pipedrive__WEBPACK_IMPORTED_MODULE_47__);
/* harmony import */ var next_auth_providers_reddit__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(9852);
/* harmony import */ var next_auth_providers_reddit__WEBPACK_IMPORTED_MODULE_48___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_reddit__WEBPACK_IMPORTED_MODULE_48__);
/* harmony import */ var next_auth_providers_salesforce__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(7269);
/* harmony import */ var next_auth_providers_salesforce__WEBPACK_IMPORTED_MODULE_49___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_salesforce__WEBPACK_IMPORTED_MODULE_49__);
/* harmony import */ var next_auth_providers_slack__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(8881);
/* harmony import */ var next_auth_providers_slack__WEBPACK_IMPORTED_MODULE_50___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_slack__WEBPACK_IMPORTED_MODULE_50__);
/* harmony import */ var next_auth_providers_spotify__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(2675);
/* harmony import */ var next_auth_providers_spotify__WEBPACK_IMPORTED_MODULE_51___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_spotify__WEBPACK_IMPORTED_MODULE_51__);
/* harmony import */ var next_auth_providers_strava__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(8718);
/* harmony import */ var next_auth_providers_strava__WEBPACK_IMPORTED_MODULE_52___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_strava__WEBPACK_IMPORTED_MODULE_52__);
/* harmony import */ var next_auth_providers_todoist__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(4125);
/* harmony import */ var next_auth_providers_todoist__WEBPACK_IMPORTED_MODULE_53___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_todoist__WEBPACK_IMPORTED_MODULE_53__);
/* harmony import */ var next_auth_providers_twitch__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(8630);
/* harmony import */ var next_auth_providers_twitch__WEBPACK_IMPORTED_MODULE_54___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_twitch__WEBPACK_IMPORTED_MODULE_54__);
/* harmony import */ var next_auth_providers_united_effects__WEBPACK_IMPORTED_MODULE_55__ = __webpack_require__(1141);
/* harmony import */ var next_auth_providers_united_effects__WEBPACK_IMPORTED_MODULE_55___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_united_effects__WEBPACK_IMPORTED_MODULE_55__);
/* harmony import */ var next_auth_providers_vk__WEBPACK_IMPORTED_MODULE_56__ = __webpack_require__(3979);
/* harmony import */ var next_auth_providers_vk__WEBPACK_IMPORTED_MODULE_56___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_vk__WEBPACK_IMPORTED_MODULE_56__);
/* harmony import */ var next_auth_providers_wikimedia__WEBPACK_IMPORTED_MODULE_57__ = __webpack_require__(1818);
/* harmony import */ var next_auth_providers_wikimedia__WEBPACK_IMPORTED_MODULE_57___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_wikimedia__WEBPACK_IMPORTED_MODULE_57__);
/* harmony import */ var next_auth_providers_wordpress__WEBPACK_IMPORTED_MODULE_58__ = __webpack_require__(9350);
/* harmony import */ var next_auth_providers_wordpress__WEBPACK_IMPORTED_MODULE_58___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_wordpress__WEBPACK_IMPORTED_MODULE_58__);
/* harmony import */ var next_auth_providers_yandex__WEBPACK_IMPORTED_MODULE_59__ = __webpack_require__(4037);
/* harmony import */ var next_auth_providers_yandex__WEBPACK_IMPORTED_MODULE_59___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_yandex__WEBPACK_IMPORTED_MODULE_59__);
/* harmony import */ var next_auth_providers_zitadel__WEBPACK_IMPORTED_MODULE_60__ = __webpack_require__(4835);
/* harmony import */ var next_auth_providers_zitadel__WEBPACK_IMPORTED_MODULE_60___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_zitadel__WEBPACK_IMPORTED_MODULE_60__);
/* harmony import */ var next_auth_providers_zoho__WEBPACK_IMPORTED_MODULE_61__ = __webpack_require__(2624);
/* harmony import */ var next_auth_providers_zoho__WEBPACK_IMPORTED_MODULE_61___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_zoho__WEBPACK_IMPORTED_MODULE_61__);
/* harmony import */ var next_auth_providers_zoom__WEBPACK_IMPORTED_MODULE_62__ = __webpack_require__(3930);
/* harmony import */ var next_auth_providers_zoom__WEBPACK_IMPORTED_MODULE_62___default = /*#__PURE__*/__webpack_require__.n(next_auth_providers_zoom__WEBPACK_IMPORTED_MODULE_62__);
/* harmony import */ var process__WEBPACK_IMPORTED_MODULE_63__ = __webpack_require__(9369);
/* harmony import */ var process__WEBPACK_IMPORTED_MODULE_63___default = /*#__PURE__*/__webpack_require__.n(process__WEBPACK_IMPORTED_MODULE_63__);
var __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_api_verifySubscription__WEBPACK_IMPORTED_MODULE_2__, _auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_3__]);
([_lib_api_verifySubscription__WEBPACK_IMPORTED_MODULE_2__, _auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);
































































const emailEnabled = process__WEBPACK_IMPORTED_MODULE_63__.env.EMAIL_FROM && process__WEBPACK_IMPORTED_MODULE_63__.env.EMAIL_SERVER ? true : false;
const newSsoUsersDisabled = process__WEBPACK_IMPORTED_MODULE_63__.env.DISABLE_NEW_SSO_USERS === "true";
const adapter = (0,_auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_3__.PrismaAdapter)(_lib_api_db__WEBPACK_IMPORTED_MODULE_0__/* .prisma */ ._);
const STRIPE_SECRET_KEY = process__WEBPACK_IMPORTED_MODULE_63__.env.STRIPE_SECRET_KEY;
const providers = [];
if (true) {
    // undefined is for backwards compatibility
    providers.push(next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_17___default()({
        type: "credentials",
        credentials: {},
        async authorize (credentials, req) {
            console.log("User log in attempt...");
            if (!credentials) return null;
            const { username, password } = credentials;
            const user = await _lib_api_db__WEBPACK_IMPORTED_MODULE_0__/* .prisma */ ._.user.findFirst({
                where: emailEnabled ? {
                    OR: [
                        {
                            username: username.toLowerCase()
                        },
                        {
                            email: username?.toLowerCase()
                        }
                    ]
                } : {
                    username: username.toLowerCase()
                }
            });
            if (!user) throw Error("Invalid credentials.");
            else if (!user?.emailVerified && emailEnabled) {
                throw Error("Email not verified.");
            }
            let passwordMatches = false;
            if (user?.password) {
                passwordMatches = bcrypt__WEBPACK_IMPORTED_MODULE_4___default().compareSync(password, user.password);
            }
            if (passwordMatches && user?.password) {
                return {
                    id: user?.id
                };
            } else throw Error("Invalid credentials.");
        }
    }));
}
if (emailEnabled) {
    providers.push(next_auth_providers_email__WEBPACK_IMPORTED_MODULE_21___default()({
        server: process__WEBPACK_IMPORTED_MODULE_63__.env.EMAIL_SERVER,
        from: process__WEBPACK_IMPORTED_MODULE_63__.env.EMAIL_FROM,
        maxAge: 1200,
        async sendVerificationRequest ({ identifier, url, provider, token }) {
            const recentVerificationRequestsCount = await _lib_api_db__WEBPACK_IMPORTED_MODULE_0__/* .prisma */ ._.verificationToken.count({
                where: {
                    identifier,
                    createdAt: {
                        gt: new Date(new Date().getTime() - 1000 * 60 * 5)
                    }
                }
            });
            if (recentVerificationRequestsCount >= 4) throw Error("Too many requests. Please try again later.");
            (0,_lib_api_sendVerificationRequest__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)({
                identifier,
                url,
                from: provider.from,
                token
            });
        }
    }));
}
// 42 School
if (false) {}
// Apple
if (false) {}
// Atlassian
if (false) {}
// Auth0
if (false) {}
// Authelia
if (false) {}
// Authentik
if (false) {}
// Azure AD B2C
if (false) {}
// Azure AD
if (false) {}
// Battle.net
if (false) {}
// Box
if (false) {}
// Cognito
if (false) {}
// Coinbase
if (false) {}
// Discord
if (false) {}
// Dropbox
if (false) {}
// Duende IdentityServer6
if (false) {}
// EVE Online
if (false) {}
// Facebook
if (false) {}
// FACEIT
if (false) {}
// Foursquare
if (false) {}
// Freshbooks
if (false) {}
// FusionAuth
if (false) {}
// GitHub
if (false) {}
// GitLab
if (false) {}
// Google
if (false) {}
// HubSpot
if (false) {}
// IdentityServer4
if (false) {}
// Kakao
if (false) {}
// Keycloak
if (false) {}
// LINE
if (false) {}
// LinkedIn
if (false) {}
// Mailchimp
if (false) {}
// Mail.ru
if (false) {}
// Naver
if (false) {}
// Netlify
if (false) {}
// Okta
if (false) {}
// OneLogin
if (false) {}
// Osso
if (false) {}
// osu!
if (false) {}
// Patreon
if (false) {}
// Pinterest
if (false) {}
// Pipedrive
if (false) {}
// Reddit
if (false) {}
// Salesforce
if (false) {}
// Slack
if (false) {}
// Spotify
if (false) {}
// Strava
if (false) {}
// Todoist
if (false) {}
// Twitch
if (false) {}
// United Effects
if (false) {}
// VK
if (false) {}
// Wikimedia
if (false) {}
// Wordpress.com
if (false) {}
// Yandex
if (false) {}
// Zitadel
if (false) {}
// Zoho
if (false) {}
// Zoom
if (process__WEBPACK_IMPORTED_MODULE_63__.env.NEXT_PUBLIC_ZOOM_ENABLED_ENABLED === "true") {
    providers.push(next_auth_providers_zoom__WEBPACK_IMPORTED_MODULE_62___default()({
        clientId: process__WEBPACK_IMPORTED_MODULE_63__.env.ZOOM_CLIENT_ID,
        clientSecret: process__WEBPACK_IMPORTED_MODULE_63__.env.ZOOM_CLIENT_SECRET
    }));
    const _linkAccount = adapter.linkAccount;
    adapter.linkAccount = (account)=>{
        const { "not-before-policy": _, refresh_expires_in, ...data } = account;
        return _linkAccount ? _linkAccount(data) : undefined;
    };
}
async function auth(req, res) {
    return await next_auth_next__WEBPACK_IMPORTED_MODULE_5___default()(req, res, {
        adapter: adapter,
        session: {
            strategy: "jwt",
            maxAge: 30 * 24 * 60 * 60
        },
        providers,
        pages: {
            signIn: "/login",
            verifyRequest: "/confirmation"
        },
        callbacks: {
            async signIn ({ user, account, profile, email, credentials }) {
                if (account?.provider !== "credentials") {
                    // registration via SSO can be separately disabled
                    const existingUser = await _lib_api_db__WEBPACK_IMPORTED_MODULE_0__/* .prisma */ ._.account.findFirst({
                        where: {
                            providerAccountId: account?.providerAccountId
                        }
                    });
                    if (!existingUser && newSsoUsersDisabled) {
                        return false;
                    }
                    // If user is already registered, link the provider
                    if (user.email && account) {
                        const findUser = await _lib_api_db__WEBPACK_IMPORTED_MODULE_0__/* .prisma */ ._.user.findFirst({
                            where: {
                                email: user.email
                            },
                            include: {
                                accounts: true
                            }
                        });
                        if (findUser && findUser.accounts.length === 0) {
                            await _lib_api_db__WEBPACK_IMPORTED_MODULE_0__/* .prisma */ ._.account.create({
                                data: {
                                    userId: findUser.id,
                                    type: account.type,
                                    provider: account.provider,
                                    providerAccountId: account.providerAccountId,
                                    id_token: account.id_token,
                                    access_token: account.access_token,
                                    refresh_token: account.refresh_token,
                                    expires_at: account.expires_at,
                                    token_type: account.token_type,
                                    scope: account.scope,
                                    session_state: account.session_state
                                }
                            });
                        }
                    }
                }
                return true;
            },
            async jwt ({ token, trigger, user }) {
                token.sub = token.sub ? Number(token.sub) : undefined;
                if (trigger === "signIn" || trigger === "signUp") token.id = user?.id;
                if (trigger === "signUp") {
                    const userExists = await _lib_api_db__WEBPACK_IMPORTED_MODULE_0__/* .prisma */ ._.user.findUnique({
                        where: {
                            id: token.id
                        },
                        include: {
                            accounts: true
                        }
                    });
                    // Verify SSO user email
                    if (userExists && userExists.accounts.length > 0) {
                        await _lib_api_db__WEBPACK_IMPORTED_MODULE_0__/* .prisma */ ._.user.update({
                            where: {
                                id: userExists.id
                            },
                            data: {
                                emailVerified: new Date()
                            }
                        });
                    }
                    if (userExists && !userExists.username) {
                        const autoGeneratedUsername = "user" + Math.round(Math.random() * 1000000000);
                        await _lib_api_db__WEBPACK_IMPORTED_MODULE_0__/* .prisma */ ._.user.update({
                            where: {
                                id: token.id
                            },
                            data: {
                                username: autoGeneratedUsername
                            }
                        });
                    }
                } else if (trigger === "signIn") {
                    const user = await _lib_api_db__WEBPACK_IMPORTED_MODULE_0__/* .prisma */ ._.user.findUnique({
                        where: {
                            id: token.id
                        }
                    });
                    if (user && !user.username) {
                        const autoGeneratedUsername = "user" + Math.round(Math.random() * 1000000000);
                        await _lib_api_db__WEBPACK_IMPORTED_MODULE_0__/* .prisma */ ._.user.update({
                            where: {
                                id: user.id
                            },
                            data: {
                                username: autoGeneratedUsername
                            }
                        });
                    }
                }
                return token;
            },
            async session ({ session, token }) {
                session.user.id = token.id;
                console.log("session", session);
                if (STRIPE_SECRET_KEY) {
                    const user = await _lib_api_db__WEBPACK_IMPORTED_MODULE_0__/* .prisma */ ._.user.findUnique({
                        where: {
                            id: token.id
                        },
                        include: {
                            subscriptions: true
                        }
                    });
                    if (user) {
                        //
                        const subscribedUser = await (0,_lib_api_verifySubscription__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(user);
                    }
                }
                return session;
            }
        }
    });
}

__webpack_async_result__();
} catch(e) { __webpack_async_result__(e); } });

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, [5746], () => (__webpack_exec__(5349)));
module.exports = __webpack_exports__;

})();