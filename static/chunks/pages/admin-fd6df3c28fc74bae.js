(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{577:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return s(1500)}])},2144:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var r=s(5893),n=s(7294);function a(e){let t=0;for(;e;){let s=window.getComputedStyle(e).getPropertyValue("z-index"),r=Number(s);if("auto"!==s&&!isNaN(r)){t=r;break}e=e.parentElement}return t}function l(e){let{children:t,onClickOutside:s,className:l,style:i,onMount:o}=e,d=(0,n.useRef)(null);return(0,n.useEffect)(()=>{function e(e){let t=e.target;if(d.current&&!d.current.contains(t)){let r=a(d.current),n=a(t);n<=r&&s(e)}}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[d,s]),(0,n.useEffect)(()=>{if(d.current&&o){let e=d.current.getBoundingClientRect();o(e)}},[]),(0,r.jsx)("div",{ref:d,className:l,style:i,children:t})}},7169:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var r=s(5893),n=s(7294),a=s(2144),l=s(2314);function i(e){let{toggleModal:t,className:s,children:i,dismissible:o=!0}=e,[d,c]=n.useState(!0);return((0,n.useEffect)(()=>{if(window.innerWidth>=640)return document.body.style.overflow="hidden",document.body.style.position="relative",()=>{document.body.style.overflow="auto",document.body.style.position=""}},[]),window.innerWidth<640)?(0,r.jsx)(l.d.Root,{open:d,onClose:()=>o&&setTimeout(()=>t(),100),dismissible:o,children:(0,r.jsxs)(l.d.Portal,{children:[(0,r.jsx)(l.d.Overlay,{className:"fixed inset-0 bg-black/40"}),(0,r.jsx)(a.Z,{onClickOutside:()=>o&&c(!1),children:(0,r.jsx)(l.d.Content,{className:"flex flex-col rounded-t-2xl min-h-max mt-24 fixed bottom-0 left-0 right-0 z-30",children:(0,r.jsxs)("div",{className:"p-4 bg-base-100 rounded-t-2xl flex-1 border-neutral-content border-t overflow-y-auto","data-testid":"mobile-modal-container",children:[(0,r.jsx)("div",{className:"mx-auto w-12 h-1.5 flex-shrink-0 rounded-full bg-neutral mb-5","data-testid":"mobile-modal-slider"}),i]})})})]})}):(0,r.jsx)("div",{className:"overflow-y-auto pt-2 sm:py-2 fixed top-0 bottom-0 right-0 left-0 bg-black bg-opacity-10 backdrop-blur-sm flex justify-center items-center fade-in z-40","data-testid":"modal-outer",children:(0,r.jsx)(a.Z,{onClickOutside:()=>o&&t(),className:"w-full mt-auto sm:m-auto sm:w-11/12 sm:max-w-2xl ".concat(s||""),children:(0,r.jsxs)("div",{className:"slide-up mt-auto sm:m-auto relative border-neutral-content rounded-t-2xl sm:rounded-2xl border-t sm:border shadow-2xl p-5 bg-base-100 overflow-y-auto sm:overflow-y-visible","data-testid":"modal-container",children:[o&&(0,r.jsx)("div",{onClick:t,className:"absolute top-4 right-3 btn btn-sm outline-none btn-circle btn-ghost z-10",children:(0,r.jsx)("i",{className:"bi-x text-neutral text-2xl","data-testid":"close-modal-button"})}),i]})})})}},4157:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var r=s(5893);function n(e){let{autoFocus:t,value:s,type:n,placeholder:a,onChange:l,onKeyDown:i,className:o,spellCheck:d,"data-testid":c}=e;return(0,r.jsx)("input",{"data-testid":c,spellCheck:d,autoFocus:t,type:n||"text",placeholder:a,value:s,onChange:l,onKeyDown:i,className:"w-full rounded-md p-2 border-neutral-content border-solid border outline-none focus:border-primary duration-100 ".concat(o||"")})}},7199:function(e,t,s){"use strict";var r=s(5893),n=s(8229),a=s(5139);let l=(0,a.j)("select-none relative duration-200 rounded-lg text-center w-fit flex justify-center items-center gap-2 disabled:pointer-events-none disabled:opacity-50",{variants:{intent:{accent:"bg-accent text-white hover:bg-accent/80 border border-violet-400",primary:"bg-primary text-primary-content hover:bg-primary/80",secondary:"bg-neutral-content text-secondary-foreground hover:bg-neutral-content/80 border border-neutral/30",destructive:"bg-error text-white hover:bg-error/80 border border-neutral/60",outline:"border border-input bg-background hover:bg-accent hover:text-accent-content",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{small:"h-7 px-2",medium:"h-10 px-4 py-2",large:"h-12 px-7 py-2",full:"px-4 py-2 w-full",icon:"h-10 w-10"},loading:{true:"cursor-wait"}},defaultVariants:{intent:"primary",size:"medium"}});t.Z=e=>{let{className:t,intent:s,size:a,children:i,disabled:o,loading:d=!1,...c}=e;return(0,r.jsx)("button",{className:(0,n.cn)(l({intent:s,size:a,className:t})),disabled:d||o,...c,children:i})}},1500:function(e,t,s){"use strict";s.r(t),s.d(t,{__N_SSP:function(){return y},default:function(){return _}});var r=s(5893),n=s(6501),a=s(7169),l=s(4157),i=s(7294),o=s(8276),d=s(8551),c=s(202),u=s(8029),m=s(3299);let x=()=>{let{status:e}=(0,m.useSession)();return(0,d.a)({queryKey:["users"],queryFn:async()=>{let e=await fetch("/api/v1/users");if(!e.ok)throw 401===e.status&&(window.location.href="/dashboard"),Error("Failed to fetch users.");let t=await e.json();return t.response},enabled:"authenticated"===e})},h=()=>{let e=(0,c.NL)(),{t}=(0,o.$G)();return(0,u.D)({mutationFn:async e=>{if(e.password.length<8)throw Error(t("password_length_error"));let s=n.ZP.loading(t("creating_account")),r=await fetch("/api/v1/users",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}),a=await r.json();if(!r.ok)throw Error(a.response);return n.ZP.dismiss(s),a.response},onSuccess:s=>{e.setQueryData(["users"],e=>[...e,s]),n.ZP.success(t("user_created"))},onError:e=>{n.ZP.error(e.message)}})},b=()=>{let e=(0,c.NL)(),{t}=(0,o.$G)();return(0,u.D)({mutationFn:async e=>{let s=n.ZP.loading(t("deleting_user")),r=await fetch("/api/v1/users/".concat(e),{method:"DELETE"}),a=await r.json();if(!r.ok)throw Error(a.response);return n.ZP.dismiss(s),a.response},onSuccess:(s,r)=>{e.setQueryData(["users"],e=>e.filter(e=>e.id!==r)),n.ZP.success(t("user_deleted"))},onError:e=>{n.ZP.error(e.message)}})};function f(e){let{onClose:t}=e,{t:s}=(0,o.$G)(),d=h(),[c,u]=(0,i.useState)({name:"",username:"",email:void 0,password:""}),[m,x]=(0,i.useState)(!1);async function b(e){e.preventDefault(),m||(""!==c.name&&""!==c.username&&""!==c.password?(x(!0),await d.mutateAsync(c,{onSuccess:()=>{t()}}),x(!1)):n.ZP.error(s("fill_all_fields_error")))}return(0,r.jsxs)(a.Z,{toggleModal:t,children:[(0,r.jsx)("p",{className:"text-xl font-thin",children:s("create_new_user")}),(0,r.jsx)("div",{className:"divider mb-3 mt-1"}),(0,r.jsxs)("form",{onSubmit:b,children:[(0,r.jsxs)("div",{className:"grid sm:grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"mb-2",children:s("display_name")}),(0,r.jsx)(l.Z,{placeholder:s("placeholder_johnny"),className:"bg-base-200",onChange:e=>u({...c,name:e.target.value}),value:c.name})]}),void 0,(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"mb-2",children:[s("username")," ",!1]}),(0,r.jsx)(l.Z,{placeholder:s("placeholder_john"),className:"bg-base-200",onChange:e=>u({...c,username:e.target.value}),value:c.username})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"mb-2",children:s("password")}),(0,r.jsx)(l.Z,{placeholder:"••••••••••••••",className:"bg-base-200",onChange:e=>u({...c,password:e.target.value}),value:c.password})]})]}),(0,r.jsxs)("div",{role:"note",className:"alert alert-note mt-5",children:[(0,r.jsx)("i",{className:"bi-exclamation-triangle text-xl"}),(0,r.jsx)("span",{children:(0,r.jsx)(o.cC,{i18nKey:"password_change_note",components:[(0,r.jsx)("b",{},0)]})})]}),(0,r.jsx)("div",{className:"flex justify-between items-center mt-5",children:(0,r.jsx)("button",{className:"btn btn-accent dark:border-violet-400 text-white ml-auto",type:"submit",children:s("create_user")})})]})]})}var p=s(1664),j=s.n(p),v=s(7199);function g(e){let{onClose:t,userId:s}=e,{t:n}=(0,o.$G)(),[l,d]=(0,i.useState)(!1),c=b(),u=async()=>{l||(d(!0),await c.mutateAsync(s,{onSuccess:()=>{t()}}),d(!1))};return(0,r.jsxs)(a.Z,{toggleModal:t,children:[(0,r.jsx)("p",{className:"text-xl font-thin text-red-500",children:n("delete_user")}),(0,r.jsx)("div",{className:"divider mb-3 mt-1"}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsx)("p",{children:n("confirm_user_deletion")}),(0,r.jsxs)("div",{role:"alert",className:"alert alert-warning",children:[(0,r.jsx)("i",{className:"bi-exclamation-triangle text-xl"}),(0,r.jsxs)("span",{children:[(0,r.jsxs)("b",{children:[n("warning"),":"]})," ",n("irreversible_action_warning")]})]}),(0,r.jsxs)(v.Z,{className:"ml-auto",intent:"destructive",onClick:u,children:[(0,r.jsx)("i",{className:"bi-trash text-xl"}),n("delete_confirmation")]})]})]})}var w=s(4155),N=(e,t,s,n)=>(0,r.jsxs)("div",{className:"overflow-x-auto whitespace-nowrap w-full",children:[(0,r.jsxs)("table",{className:"table w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{}),(0,r.jsx)("th",{children:n("username")}),!1,"true"===w.env.NEXT_PUBLIC_STRIPE&&(0,r.jsx)("th",{children:n("subscribed")}),(0,r.jsx)("th",{children:n("created_at")}),(0,r.jsx)("th",{})]})}),(0,r.jsx)("tbody",{children:e.map((e,t)=>{var a;return(0,r.jsxs)("tr",{className:"group hover:bg-neutral-content hover:bg-opacity-30 duration-100",children:[(0,r.jsx)("td",{className:"text-primary",children:t+1}),(0,r.jsx)("td",{children:e.username?e.username:(0,r.jsx)("b",{children:n("not_available")})}),!1,"true"===w.env.NEXT_PUBLIC_STRIPE&&(0,r.jsx)("td",{children:(null===(a=e.subscriptions)||void 0===a?void 0:a.active)?(0,r.jsx)("i",{className:"bi bi-check text-green-500"}):(0,r.jsx)("i",{className:"bi bi-x text-red-500"})}),(0,r.jsx)("td",{children:new Date(e.createdAt).toLocaleString()}),(0,r.jsx)("td",{className:"relative",children:(0,r.jsx)("button",{className:"btn btn-sm btn-ghost duration-100 hidden group-hover:block absolute z-20 right-[0.35rem] top-[0.35rem]",onClick:()=>s({isOpen:!0,userId:e.id}),children:(0,r.jsx)("i",{className:"bi bi-trash"})})})]},t)})})]}),t.isOpen&&t.userId?(0,r.jsx)(g,{onClose:()=>s({isOpen:!1,userId:null}),userId:t.userId}):null]}),y=!0;function _(){let{t:e}=(0,o.$G)(),{data:t=[]}=x(),[s,n]=(0,i.useState)(""),[a,l]=(0,i.useState)(),[d,c]=(0,i.useState)({isOpen:!1,userId:null}),[u,m]=(0,i.useState)(!1);return(0,r.jsxs)("div",{className:"max-w-6xl mx-auto p-5",children:[(0,r.jsxs)("div",{className:"flex sm:flex-row flex-col justify-between gap-2",children:[(0,r.jsxs)("div",{className:"gap-2 inline-flex items-center",children:[(0,r.jsx)(j(),{href:"/dashboard",className:"text-neutral btn btn-square btn-sm btn-ghost",children:(0,r.jsx)("i",{className:"bi-chevron-left text-xl"})}),(0,r.jsx)("p",{className:"capitalize text-3xl font-thin inline",children:e("user_administration")})]}),(0,r.jsxs)("div",{className:"flex items-center relative justify-between gap-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"search-box",className:"inline-flex items-center w-fit absolute left-1 pointer-events-none rounded-md p-1 text-primary",children:(0,r.jsx)("i",{className:"bi-search"})}),(0,r.jsx)("input",{id:"search-box",type:"text",placeholder:e("search_users"),value:s,onChange:e=>{n(e.target.value),t&&l(t.filter(t=>JSON.stringify(t).toLowerCase().includes(e.target.value.toLowerCase())))},className:"border border-neutral-content bg-base-200 focus:border-primary py-1 rounded-md pl-9 pr-2 w-full max-w-[15rem] md:w-[15rem] md:max-w-full duration-200 outline-none"})]}),(0,r.jsx)("div",{onClick:()=>m(!0),className:"flex items-center btn btn-accent dark:border-violet-400 text-white btn-sm px-2 aspect-square relative",children:(0,r.jsx)("i",{className:"bi-plus text-3xl absolute"})})]})]}),(0,r.jsx)("div",{className:"divider my-3"}),a&&a.length>0&&""!==s?N(a,d,c,e):""!==s?(0,r.jsx)("p",{children:e("no_user_found_in_search")}):t&&t.length>0?N(t,d,c,e):(0,r.jsx)("p",{children:e("no_users_found")}),u?(0,r.jsx)(f,{onClose:()=>m(!1)}):null]})}}},function(e){e.O(0,[664,584,774,888,179],function(){return e(e.s=577)}),_N_E=e.O()}]);