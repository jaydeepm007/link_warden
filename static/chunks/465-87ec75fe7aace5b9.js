"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[465],{6081:function(e,t,l){l.d(t,{Z:function(){return u}});var n=l(5893),s=l(7294),a=l(4157),i=l(5651),r=l(7169),o=l(8276),d=l(7179),c=l(6501);function u(e){let{onClose:t,parent:l}=e,{t:u}=(0,o.$G)(),m={parentId:null==l?void 0:l.id,name:"",description:"",color:"#0ea5e9"},[x,h]=(0,s.useState)(m);(0,s.useEffect)(()=>{h(m)},[]);let[p,b]=(0,s.useState)(!1),f=(0,d.$J)(),v=async()=>{if(p)return;if(!x)return null;b(!0);let e=c.ZP.loading(u("creating"));await f.mutateAsync(x,{onSettled:(l,n)=>{c.ZP.dismiss(e),n?c.ZP.error(n.message):(t(),c.ZP.success(u("created")))}}),b(!1)};return(0,n.jsxs)(r.Z,{toggleModal:t,children:[(null==l?void 0:l.id)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-xl font-thin",children:u("new_sub_collection")}),(0,n.jsx)("p",{className:"capitalize text-sm",children:u("for_collection",{name:l.name})})]}):(0,n.jsx)("p",{className:"text-xl font-thin",children:u("create_new_collection")}),(0,n.jsx)("div",{className:"divider mb-3 mt-1"}),(0,n.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("p",{className:"mb-2",children:u("name")}),(0,n.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,n.jsx)(a.Z,{className:"bg-base-200",value:x.name,placeholder:u("collection_name_placeholder"),onChange:e=>h({...x,name:e.target.value})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"w-full mb-2",children:u("color")}),(0,n.jsxs)("div",{className:"color-picker flex justify-between items-center",children:[(0,n.jsx)(i.gW,{color:x.color,onChange:e=>h({...x,color:e})}),(0,n.jsxs)("div",{className:"flex flex-col gap-2 items-center w-32",children:[(0,n.jsx)("i",{className:"bi-folder-fill text-5xl",style:{color:x.color}}),(0,n.jsx)("div",{className:"btn btn-ghost btn-xs",onClick:()=>h({...x,color:"#0ea5e9"}),children:u("reset")})]})]})]})]})]}),(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsx)("p",{className:"mb-2",children:u("description")}),(0,n.jsx)("textarea",{className:"w-full h-[13rem] resize-none border rounded-md duration-100 bg-base-200 p-2 outline-none border-neutral-content focus:border-primary",placeholder:u("collection_description_placeholder"),value:x.description,onChange:e=>h({...x,description:e.target.value})})]})]}),(0,n.jsx)("button",{className:"btn btn-accent dark:border-violet-400 text-white w-fit ml-auto",onClick:v,children:u("create_collection_button")})]})]})}},5016:function(e,t,l){l.d(t,{Z:function(){return b}});var n=l(5893),s=l(7294),a=l(1810),i=l(2122),r=l(4157),o=l(9401),d=l(3299),c=l(1163),u=l(7169),m=l(8276),x=l(7179),h=l(6496),p=l(6501);function b(e){let{onClose:t}=e,{t:l}=(0,m.$G)(),{data:b}=(0,d.useSession)(),f={name:"",url:"",description:"",type:"url",tags:[],preview:"",image:"",pdf:"",readable:"",monolith:"",textContent:"",collection:{name:"",ownerId:null==b?void 0:b.user.id}},[v,j]=(0,s.useState)(f),g=(0,h.Mj)(),[w,N]=(0,s.useState)(!1),[y,k]=(0,s.useState)(!1),I=(0,c.useRouter)(),{data:_=[]}=(0,x.bX)();(0,s.useEffect)(()=>{if(I.query.id){let e=_.find(e=>e.id==Number(I.query.id));e&&e.ownerId&&I.asPath.startsWith("/collections/")&&j({...f,collection:{id:e.id,name:e.name,ownerId:e.ownerId}})}else j({...f,collection:{name:"Unorganized",ownerId:null==b?void 0:b.user.id}})},[]);let C=async()=>{if(!w){N(!0);let e=p.ZP.loading(l("creating_link"));await g.mutateAsync(v,{onSettled:(n,s)=>{p.ZP.dismiss(e),s?p.ZP.error(s.message):(t(),p.ZP.success(l("link_created")))}}),N(!1)}};return(0,n.jsxs)(u.Z,{toggleModal:t,children:[(0,n.jsx)("p",{className:"text-xl font-thin",children:l("create_new_link")}),(0,n.jsx)("div",{className:"divider mb-3 mt-1"}),(0,n.jsxs)("div",{className:"grid grid-flow-row-dense sm:grid-cols-5 gap-3",children:[(0,n.jsxs)("div",{className:"sm:col-span-3 col-span-5",children:[(0,n.jsx)("p",{className:"mb-2",children:l("link")}),(0,n.jsx)(r.Z,{value:v.url||"",onChange:e=>j({...v,url:e.target.value}),placeholder:l("link_url_placeholder"),className:"bg-base-200"})]}),(0,n.jsxs)("div",{className:"sm:col-span-2 col-span-5",children:[(0,n.jsx)("p",{className:"mb-2",children:l("collection")}),v.collection.name?(0,n.jsx)(a.Z,{onChange:e=>{(null==e?void 0:e.__isNew__)&&(e.value=null),j({...v,collection:{id:null==e?void 0:e.value,name:null==e?void 0:e.label,ownerId:null==e?void 0:e.ownerId}})},defaultValue:{label:v.collection.name,value:v.collection.id}}):null]})]}),(0,n.jsx)("div",{className:"mt-2",children:y?(0,n.jsx)("div",{className:"mt-5",children:(0,n.jsxs)("div",{className:"grid sm:grid-cols-2 gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"mb-2",children:l("name")}),(0,n.jsx)(r.Z,{value:v.name,onChange:e=>j({...v,name:e.target.value}),placeholder:l("link_name_placeholder"),className:"bg-base-200"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"mb-2",children:l("tags")}),(0,n.jsx)(i.Z,{onChange:e=>{let t=e.map(e=>({name:e.label}));j({...v,tags:t})},defaultValue:v.tags.map(e=>({label:e.name,value:e.id}))})]}),(0,n.jsxs)("div",{className:"sm:col-span-2",children:[(0,n.jsx)("p",{className:"mb-2",children:l("description")}),(0,n.jsx)("textarea",{value:(0,o.Z)(v.description),onChange:e=>j({...v,description:e.target.value}),placeholder:l("link_description_placeholder"),className:"resize-none w-full rounded-md p-2 border-neutral-content bg-base-200 focus:border-primary border-solid border outline-none duration-100"})]})]})}):void 0}),(0,n.jsxs)("div",{className:"flex justify-between items-center mt-5",children:[(0,n.jsxs)("div",{onClick:()=>k(!y),className:"rounded-md cursor-pointer btn btn-sm btn-ghost duration-100 flex items-center px-2 w-fit text-sm",children:[(0,n.jsx)("p",{children:y?l("hide_options"):l("more_options")}),(0,n.jsx)("i",{className:"bi-chevron-".concat(y?"up":"down")})]}),(0,n.jsx)("button",{className:"btn btn-accent dark:border-violet-400 text-white",onClick:C,children:l("create_link")})]})]})}},5130:function(e,t,l){l.d(t,{Z:function(){return r}});var n=l(5893),s=l(7294),a=l(5675),i=l.n(a);function r(e){let{src:t,className:l,priority:a,name:r,large:o}=e,[d,c]=(0,s.useState)("");return(0,s.useEffect)(()=>{!t||(null==t?void 0:t.includes("base64"))||t.startsWith("http")?t?c(t):c(""):c("/api/v1/".concat(t.replace("uploads/","").replace(".jpg","")))},[t]),d?(0,n.jsx)("div",{className:"avatar skeleton rounded-full drop-shadow-md ".concat(l||""," ").concat(o?"w-28 h-28":"w-8 h-8"),children:(0,n.jsx)("div",{className:"rounded-full w-full h-full ring-2 ring-neutral-content",children:(0,n.jsx)(i(),{alt:"",src:d,height:112,width:112,priority:a,draggable:!1,onError:()=>c(""),className:"aspect-square rounded-full"})})}):(0,n.jsx)("div",{className:"avatar drop-shadow-md placeholder ".concat(l||""," ").concat(o?"w-28 h-28":"w-8 h-8"),children:(0,n.jsx)("div",{className:"bg-base-100 text-neutral rounded-full w-full h-full ring-2 ring-neutral-content select-none",children:r?(0,n.jsx)("span",{className:"text-2xl capitalize",children:r.slice(0,1)}):(0,n.jsx)("i",{className:"bi-person ".concat(o?"text-5xl":"text-xl")})})})}},2948:function(e,t,l){l.d(t,{Z:function(){return r}});var n=l(5893),s=l(7294),a=l(1163),i=l(6501);function r(e){let{placeholder:t}=e,l=(0,a.useRouter)(),[r,o]=(0,s.useState)("");return(0,s.useEffect)(()=>{l.query.q?o(decodeURIComponent(l.query.q)):o("")},[l.query.q]),(0,n.jsxs)("div",{className:"flex items-center relative group",children:[(0,n.jsx)("label",{htmlFor:"search-box",className:"inline-flex items-center w-fit absolute left-1 pointer-events-none rounded-md p-1 text-primary",children:(0,n.jsx)("i",{className:"bi-search"})}),(0,n.jsx)("input",{id:"search-box",type:"text",placeholder:t||"Search for Links",value:r,onChange:e=>{e.target.value.includes("%")&&i.Am.error("The search query should not contain '%'."),o(e.target.value.replace("%",""))},onKeyDown:e=>{if("Enter"===e.key)return l.pathname.startsWith("/public")?r?l.push("/public/collections/"+l.query.id+"?q="+encodeURIComponent(r||"")):l.push("/public/collections/"+l.query.id):l.push("/search?q="+encodeURIComponent(r))},className:"border border-neutral-content bg-base-200 focus:border-primary py-1 rounded-md pl-9 pr-2 w-full max-w-[15rem] md:focus:w-80 md:w-[15rem] md:max-w-full duration-200 outline-none"})]})}},1566:function(e,t,l){l.d(t,{Z:function(){return r}});var n=l(5893),s=l(7472),a=l(7294),i=l(8276);function r(e){let{className:t}=e,{t:l}=(0,i.$G)(),{settings:r,updateSettings:o}=(0,s.Z)(),[d,c]=(0,a.useState)(localStorage.getItem("theme"));return(0,a.useEffect)(()=>{o({theme:d})},[d]),(0,n.jsx)("div",{className:"tooltip tooltip-bottom","data-tip":l("switch_to",{theme:"light"===r.theme?"Dark":"Light"}),children:(0,n.jsxs)("label",{className:"swap swap-rotate btn-square text-neutral btn btn-ghost btn-sm ".concat(t),children:[(0,n.jsx)("input",{type:"checkbox",onChange:e=>{c(e.target.checked?"dark":"light")},className:"theme-controller",checked:"light"!==localStorage.getItem("theme")}),(0,n.jsx)("i",{className:"bi-sun-fill text-xl swap-on"}),(0,n.jsx)("i",{className:"bi-moon-fill text-xl swap-off"})]})})}},8050:function(e,t,l){l.d(t,{Z:function(){return s}});var n=l(7294);function s(){let[e,t]=(0,n.useState)({height:window.innerHeight,width:window.innerWidth});return(0,n.useEffect)(()=>{function e(){t({height:window.innerHeight,width:window.innerWidth})}return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),e}},8465:function(e,t,l){l.d(t,{Z:function(){return X}});var n=l(5893),s=l(7294),a=l(2144),i=l(1664),r=l.n(i),o=l(1163),d=l(9167),c=l(5760);function u(e){let{title:t,href:l,icon:s,active:a}=e;return(0,n.jsx)(r(),{href:l,children:(0,n.jsxs)("div",{title:t,className:"".concat(a?"bg-primary/20":"bg-neutral-content/20 hover:bg-neutral/20"," duration-200 px-3 py-2 cursor-pointer gap-2 w-full rounded-lg capitalize"),children:[(0,n.jsx)("div",{className:"w-10 h-10 inline-flex items-center justify-center bg-black/10 dark:bg-white/5 rounded-full",children:(0,n.jsx)("i",{className:"".concat(s," text-primary text-2xl drop-shadow")})}),(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)("p",{className:"truncate w-full font-semibold text-xs",children:t})})]})})}var m=l(5625),x=l(227),h=l(9218),p=l(6501),b=l(8276),f=l(7179),v=l(2676),j=()=>{let{t:e}=(0,b.$G)(),t=(0,f.vU)(),{data:l=[],isLoading:a}=(0,f.bX)(),{data:i={}}=(0,v.a)(),r=(0,v.I)(),d=(0,o.useRouter)(),c=d.asPath,[u,j]=(0,s.useState)(),w=(0,s.useMemo)(()=>l.length>0?N(l,d,i.collectionOrder):void 0,[l,i,d]);(0,s.useEffect)(()=>{j(w)},[w]),(0,s.useEffect)(()=>{if(i.username){if((!i.collectionOrder||0===i.collectionOrder.length)&&l.length>0)r.mutate({...i,collectionOrder:l.filter(e=>null===e.parentId||!l.find(t=>t.id===e.parentId)).map(e=>e.id)});else{let e=[...i.collectionOrder||[]],t=l.map(e=>e.id),n=i.collectionOrder.filter(e=>t.includes(e));l.forEach(e=>{n.includes(e.id)||e.parentId&&e.ownerId!==i.id||n.push(e.id)}),JSON.stringify(e)!==JSON.stringify(i.collectionOrder)&&r.mutateAsync({...i,collectionOrder:e})}}},[l]);let y=async(n,s)=>{if(!s||!u||n.index===s.index&&n.parentId===s.parentId)return;let a=Number(u.items[n.parentId].children[n.index]),o=l.find(e=>e.id===a),d=l.find(e=>e.id===Number(s.parentId));if((null==o?void 0:o.ownerId)!==i.id&&s.parentId!==n.parentId||(null==d?void 0:d.ownerId)!==i.id&&"root"!==s.parentId)return p.ZP.error(e("cant_change_collection_you_dont_own"));j(e=>(0,x.d)(e,n,s));let c=[...i.collectionOrder];n.parentId!==s.parentId&&await t.mutateAsync({...o,parentId:s.parentId&&"root"!==s.parentId?Number(s.parentId):"root"===s.parentId?"root":null},{onError:e=>{p.ZP.error(e.message)}}),void 0!==s.index&&s.parentId===n.parentId&&"root"===n.parentId?(c.includes(a)&&c.splice(n.index,1),c.splice(s.index,0,a),await r.mutateAsync({...i,collectionOrder:c})):void 0!==s.index&&"root"===s.parentId?(c.splice(s.index,0,a),r.mutate({...i,collectionOrder:c})):"root"===n.parentId&&s.parentId&&"root"!==s.parentId&&(c.splice(n.index,1),await r.mutateAsync({...i,collectionOrder:c}))};return a?(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsx)("div",{className:"skeleton h-4 w-full"}),(0,n.jsx)("div",{className:"skeleton h-4 w-full"}),(0,n.jsx)("div",{className:"skeleton h-4 w-full"})]}):u?(0,n.jsx)(h.Z,{tree:u,renderItem:e=>g({...e},c),onExpand:e=>{j(t=>(0,m.U)(t,e,{isExpanded:!0}))},onCollapse:e=>{j(t=>(0,m.U)(t,e,{isExpanded:!1}))},onDragEnd:y,isDragEnabled:!0,isNestingEnabled:!0}):(0,n.jsx)("p",{className:"text-neutral text-xs font-semibold truncate w-full px-2 mt-5 mb-8",children:e("you_have_no_collections")})};let g=(e,t)=>{var l;let{item:s,onExpand:a,onCollapse:i,provided:o}=e,d=s.data;return(0,n.jsx)("div",{ref:o.innerRef,...o.draggableProps,className:"mb-1",children:(0,n.jsxs)("div",{className:"".concat(t==="/collections/".concat(d.id)?"bg-primary/20 is-active":"hover:bg-neutral/20"," duration-100 flex gap-1 items-center pr-2 pl-1 rounded-md"),children:[w(s,a,i),(0,n.jsx)(r(),{href:"/collections/".concat(d.id),className:"w-full",...o.dragHandleProps,children:(0,n.jsxs)("div",{className:"py-1 cursor-pointer flex items-center gap-2 w-full rounded-md h-8 capitalize",children:[(0,n.jsx)("i",{className:"bi-folder-fill text-2xl drop-shadow",style:{color:d.color}}),(0,n.jsx)("p",{className:"truncate w-full",children:d.name}),d.isPublic?(0,n.jsx)("i",{className:"bi-globe2 text-sm text-black/50 dark:text-white/50 drop-shadow",title:"This collection is being shared publicly."}):void 0,(0,n.jsx)("div",{className:"drop-shadow text-neutral text-xs",children:null===(l=d._count)||void 0===l?void 0:l.links})]})})]})})},w=(e,t,l)=>e.children&&e.children.length>0?e.isExpanded?(0,n.jsx)("button",{onClick:()=>l(e.id),children:(0,n.jsx)("div",{className:"bi-caret-down-fill opacity-50 hover:opacity-100 duration-200"})}):(0,n.jsx)("button",{onClick:()=>t(e.id),children:(0,n.jsx)("div",{className:"bi-caret-right-fill opacity-40 hover:opacity-100 duration-200"})}):(0,n.jsx)("div",{}),N=(e,t,l)=>{l&&e.sort((e,t)=>l.indexOf(e.id)-l.indexOf(t.id));let n=e.reduce((e,t)=>{var l;return e[t.id]={id:t.id,children:[],hasChildren:!1,isExpanded:!1,data:{id:t.id,parentId:t.parentId,name:t.name,description:t.description,color:t.color,isPublic:t.isPublic,ownerId:t.ownerId,createdAt:t.createdAt,updatedAt:t.updatedAt,_count:{links:null===(l=t._count)||void 0===l?void 0:l.links}}},e},{}),s=Number(t.asPath.split("/collections/")[1]);if(s)for(let e in n){let t=n[e];if(Number(e)===s&&t.data.parentId){let e=t.data.parentId||null;for(;e&&n[e];)n[e].isExpanded=!0,e=n[e].data.parentId}}e.forEach(e=>{let t=e.parentId;t&&n[t]&&e.id&&(n[t].children.push(e.id),n[t].hasChildren=!0)});let a="root";return n[a]={id:a,children:e.filter(t=>null===t.parentId||!e.find(e=>e.id===t.parentId)).map(e=>e.id)||"",hasChildren:!0,isExpanded:!0,data:{name:"Root"}},{rootId:a,items:n}};var y=l(4806);function k(e){let{className:t}=e,{t:l}=(0,b.$G)(),[a,i]=(0,s.useState)(()=>{let e=localStorage.getItem("tagDisclosure");return!e||"true"===e}),[m,x]=(0,s.useState)(()=>{let e=localStorage.getItem("collectionDisclosure");return!e||"true"===e}),{data:h}=(0,f.bX)(),{data:p=[],isLoading:v}=(0,y.e0)(),[g,w]=(0,s.useState)(""),N=(0,o.useRouter)();return(0,s.useEffect)(()=>{localStorage.setItem("tagDisclosure",a?"true":"false")},[a]),(0,s.useEffect)(()=>{localStorage.setItem("collectionDisclosure",m?"true":"false")},[m]),(0,s.useEffect)(()=>{w(N.asPath)},[N,h]),(0,n.jsxs)("div",{id:"sidebar",className:"bg-base-200 h-full w-80 overflow-y-auto border-solid border border-base-200 border-r-neutral-content p-2 z-20 ".concat(t||""),children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,n.jsx)(u,{title:l("dashboard"),href:"/dashboard",icon:"bi-house",active:"/dashboard"===g}),(0,n.jsx)(u,{title:l("pinned"),href:"/links/pinned",icon:"bi-pin-angle",active:"/links/pinned"===g}),(0,n.jsx)(u,{title:l("all_links"),href:"/links",icon:"bi-link-45deg",active:"/links"===g}),(0,n.jsx)(u,{title:l("all_collections"),href:"/collections",icon:"bi-folder",active:"/collections"===g})]}),(0,n.jsxs)(d.p,{defaultOpen:m,children:[(0,n.jsxs)(d.p.Button,{onClick:()=>{x(!m)},className:"flex items-center justify-between w-full text-left mb-2 pl-2 font-bold text-neutral mt-5",children:[(0,n.jsx)("p",{className:"text-sm",children:l("collections")}),(0,n.jsx)("i",{className:"bi-chevron-down ".concat(m?"rotate-reverse":"rotate")})]}),(0,n.jsx)(c.u,{enter:"transition duration-100 ease-out",enterFrom:"transform opacity-0 -translate-y-3",enterTo:"transform opacity-100 translate-y-0",leave:"transition duration-100 ease-out",leaveFrom:"transform opacity-100 translate-y-0",leaveTo:"transform opacity-0 -translate-y-3",children:(0,n.jsx)(d.p.Panel,{children:(0,n.jsx)(j,{})})})]}),(0,n.jsxs)(d.p,{defaultOpen:a,children:[(0,n.jsxs)(d.p.Button,{onClick:()=>{i(!a)},className:"flex items-center justify-between w-full text-left mb-2 pl-2 font-bold text-neutral mt-5",children:[(0,n.jsx)("p",{className:"text-sm",children:l("tags")}),(0,n.jsx)("i",{className:"bi-chevron-down  ".concat(a?"rotate-reverse":"rotate")})]}),(0,n.jsx)(c.u,{enter:"transition duration-100 ease-out",enterFrom:"transform opacity-0 -translate-y-3",enterTo:"transform opacity-100 translate-y-0",leave:"transition duration-100 ease-out",leaveFrom:"transform opacity-100 translate-y-0",leaveTo:"transform opacity-0 -translate-y-3",children:(0,n.jsx)(d.p.Panel,{className:"flex flex-col gap-1",children:v?(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsx)("div",{className:"skeleton h-4 w-full"}),(0,n.jsx)("div",{className:"skeleton h-4 w-full"}),(0,n.jsx)("div",{className:"skeleton h-4 w-full"})]}):p[0]?p.sort((e,t)=>e.name.localeCompare(t.name)).map((e,t)=>{var l;return(0,n.jsx)(r(),{href:"/tags/".concat(e.id),children:(0,n.jsxs)("div",{className:"".concat(g==="/tags/".concat(e.id)?"bg-primary/20":"hover:bg-neutral/20"," duration-100 py-1 px-2 cursor-pointer flex items-center gap-2 w-full rounded-md h-8"),children:[(0,n.jsx)("i",{className:"bi-hash text-2xl text-primary drop-shadow"}),(0,n.jsx)("p",{className:"truncate w-full pr-7",children:e.name}),(0,n.jsx)("div",{className:"drop-shadow text-neutral text-xs",children:null===(l=e._count)||void 0===l?void 0:l.links})]})},t)}):(0,n.jsx)("div",{className:"duration-100 py-1 px-2 flex items-center gap-2 w-full rounded-md h-8 capitalize",children:(0,n.jsx)("p",{className:"text-neutral text-xs font-semibold truncate w-full pr-7",children:l("you_have_no_tags")})})})})]})]})}var I=l(2948),_=l(8050),C=l(1566),E=l(5016),S=l(6081),Z=l(1810),P=l(2122),z=l(4157),q=l(9401),O=l(7102),A=l(3299),R=l(7169),D=l(6496);function G(e){let{onClose:t}=e,{t:l}=(0,b.$G)(),{data:a}=(0,A.useSession)(),i={name:"",url:"",description:"",type:"url",tags:[],preview:"",image:"",pdf:"",readable:"",monolith:"",textContent:"",collection:{name:"",ownerId:null==a?void 0:a.user.id}},[r,d]=(0,s.useState)(i),[c,u]=(0,s.useState)(),m=(0,D.kR)(),[x,h]=(0,s.useState)(!1),[v,j]=(0,s.useState)(!1),g=(0,o.useRouter)(),{data:w=[]}=(0,f.bX)();(0,s.useEffect)(()=>{if(j(!1),g.query.id){let e=w.find(e=>e.id==Number(g.query.id));e&&e.ownerId&&g.asPath.startsWith("/collections/")&&d({...i,collection:{id:e.id,name:e.name,ownerId:e.ownerId}})}else d({...i,collection:{name:"Unorganized",ownerId:null==a?void 0:a.user.id}})},[g,w]);let N=async()=>{if(!x&&c){(null==c?void 0:c.type)==="image/jpg"||"image/jpeg"===c.type?O.Gt.jpeg:"image/png"===c.type?O.Gt.png:"application/pdf"===c.type&&O.Gt.pdf,h(!0);let e=p.ZP.loading(l("creating"));await m.mutateAsync({link:r,file:c},{onSettled:(n,s)=>{p.ZP.dismiss(e),s?p.ZP.error(s.message):(t(),p.ZP.success(l("created_success")))}}),h(!1)}};return(0,n.jsxs)(R.Z,{toggleModal:t,children:[(0,n.jsx)("div",{className:"flex gap-2 items-start",children:(0,n.jsx)("p",{className:"text-xl font-thin",children:l("upload_file")})}),(0,n.jsx)("div",{className:"divider mb-3 mt-1"}),(0,n.jsxs)("div",{className:"grid grid-flow-row-dense sm:grid-cols-5 gap-3",children:[(0,n.jsxs)("div",{className:"sm:col-span-3 col-span-5",children:[(0,n.jsx)("p",{className:"mb-2",children:l("file")}),(0,n.jsx)("label",{className:"btn h-10 btn-sm w-full border border-neutral-content hover:border-neutral-content flex justify-between",children:(0,n.jsx)("input",{type:"file",accept:".pdf,.png,.jpg,.jpeg,.html",className:"cursor-pointer custom-file-input",onChange:e=>e.target.files&&u(e.target.files[0])})}),(0,n.jsx)("p",{className:"text-xs font-semibold mt-2",children:l("file_types",{size:10})})]}),(0,n.jsxs)("div",{className:"sm:col-span-2 col-span-5",children:[(0,n.jsx)("p",{className:"mb-2",children:l("collection")}),r.collection.name?(0,n.jsx)(Z.Z,{onChange:e=>{(null==e?void 0:e.__isNew__)&&(e.value=null),d({...r,collection:{id:null==e?void 0:e.value,name:null==e?void 0:e.label,ownerId:null==e?void 0:e.ownerId}})},defaultValue:{label:r.collection.name,value:r.collection.id}}):null]})]}),v?(0,n.jsx)("div",{className:"mt-5",children:(0,n.jsxs)("div",{className:"grid sm:grid-cols-2 gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"mb-2",children:l("name")}),(0,n.jsx)(z.Z,{value:r.name,onChange:e=>d({...r,name:e.target.value}),placeholder:l("example_link"),className:"bg-base-200"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"mb-2",children:l("tags")}),(0,n.jsx)(P.Z,{onChange:e=>{let t=e.map(e=>({name:e.label}));d({...r,tags:t})},defaultValue:r.tags.map(e=>({label:e.name,value:e.id}))})]}),(0,n.jsxs)("div",{className:"sm:col-span-2",children:[(0,n.jsx)("p",{className:"mb-2",children:l("description")}),(0,n.jsx)("textarea",{value:(0,q.Z)(r.description),onChange:e=>d({...r,description:e.target.value}),placeholder:l("description_placeholder"),className:"resize-none w-full rounded-md p-2 border-neutral-content bg-base-200 focus:border-sky-300 dark:focus:border-sky-600 border-solid border outline-none duration-100"})]})]})}):void 0,(0,n.jsxs)("div",{className:"flex justify-between items-center mt-5",children:[(0,n.jsx)("div",{onClick:()=>j(!v),className:"rounded-md cursor-pointer btn btn-sm btn-ghost duration-100 flex items-center px-2 w-fit text-sm",children:(0,n.jsxs)("p",{children:[v?l("hide"):l("more")," ",l("options")]})}),(0,n.jsx)("button",{className:"btn btn-accent dark:border-violet-400 text-white",onClick:N,children:l("upload_file")})]})]})}var M=l(8229);function $(e){let{href:t,icon:l}=e,a=(0,o.useRouter)(),[i,d]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{d(t===a.asPath)},[a]),(0,n.jsx)(r(),{href:t,className:"w-full active:scale-[80%] duration-200 select-none",draggable:"false",style:{WebkitTouchCallout:"none"},onContextMenu:e=>(0,M.Ee)()?(e.preventDefault(),e.stopPropagation(),!1):null,children:(0,n.jsx)("div",{className:"py-2 cursor-pointer gap-2 w-full rounded-full capitalize flex items-center justify-center",children:(0,n.jsx)("i",{className:"".concat(l," text-primary text-3xl drop-shadow duration-200 rounded-full w-14 h-14 text-center pt-[0.65rem] ").concat(i?"bg-primary/20":"")})})})}function U(e){let{}=e,{t}=(0,b.$G)(),[l,a]=(0,s.useState)(!1),[i,r]=(0,s.useState)(!1),[o,d]=(0,s.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-30 duration-200 sm:hidden",children:(0,n.jsxs)("div",{className:"w-full flex bg-base-100 ".concat((0,M.qx)()&&(0,M.Ee)()?"pb-5":""," border-solid border-t-neutral-content border-t"),children:[(0,n.jsx)($,{href:"/dashboard",icon:"bi-house"}),(0,n.jsx)($,{href:"/links/pinned",icon:"bi-pin-angle"}),(0,n.jsxs)("div",{className:"dropdown dropdown-top -mt-4",children:[(0,n.jsx)("div",{tabIndex:0,role:"button",onMouseDown:M.Mm,className:"flex items-center btn btn-accent dark:border-violet-400 text-white btn-circle w-20 h-20 px-2 relative",children:(0,n.jsx)("span",{children:(0,n.jsx)("i",{className:"bi-plus text-5xl pointer-events-none"})})}),(0,n.jsxs)("ul",{className:"dropdown-content z-[1] menu shadow bg-base-200 border border-neutral-content rounded-box mb-1 -ml-12",children:[(0,n.jsx)("li",{children:(0,n.jsx)("div",{onClick:()=>{var e,t;null===(e=null===(t=document)||void 0===t?void 0:t.activeElement)||void 0===e||e.blur(),a(!0)},tabIndex:0,role:"button",className:"whitespace-nowrap",children:t("new_link")})}),(0,n.jsx)("li",{children:(0,n.jsx)("div",{onClick:()=>{var e,t;null===(e=null===(t=document)||void 0===t?void 0:t.activeElement)||void 0===e||e.blur(),d(!0)},tabIndex:0,role:"button",className:"whitespace-nowrap",children:t("upload_file")})}),(0,n.jsx)("li",{children:(0,n.jsx)("div",{onClick:()=>{var e,t;null===(e=null===(t=document)||void 0===t?void 0:t.activeElement)||void 0===e||e.blur(),r(!0)},tabIndex:0,role:"button",className:"whitespace-nowrap",children:t("new_collection")})})]})]}),(0,n.jsx)($,{href:"/links",icon:"bi-link-45deg"}),(0,n.jsx)($,{href:"/collections",icon:"bi-folder"})]})}),l?(0,n.jsx)(E.Z,{onClose:()=>a(!1)}):void 0,i?(0,n.jsx)(S.Z,{onClose:()=>r(!1)}):void 0,o?(0,n.jsx)(G,{onClose:()=>d(!1)}):void 0]})}var W=l(7472),F=l(5130);function T(){let{t:e}=(0,b.$G)(),{settings:t,updateSettings:l}=(0,W.Z)(),{data:s={}}=(0,v.a)(),a=s.id===Number(1),i=()=>{let e="dark"===t.theme?"light":"dark";l({theme:e})};return(0,n.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,n.jsx)("div",{tabIndex:0,role:"button",onMouseDown:M.Mm,className:"btn btn-circle btn-ghost",children:(0,n.jsx)(F.Z,{src:s.image?s.image:void 0,priority:!0})}),(0,n.jsxs)("ul",{className:"dropdown-content z-[1] menu shadow bg-base-200 border border-neutral-content rounded-box mt-1",children:[(0,n.jsx)("li",{children:(0,n.jsx)(r(),{href:"/settings/account",onClick:()=>{var e,t;return null===(e=null===(t=document)||void 0===t?void 0:t.activeElement)||void 0===e?void 0:e.blur()},tabIndex:0,role:"button",className:"whitespace-nowrap",children:e("settings")})}),(0,n.jsx)("li",{className:"block sm:hidden",children:(0,n.jsx)("div",{onClick:()=>{var e,t;null===(e=null===(t=document)||void 0===t?void 0:t.activeElement)||void 0===e||e.blur(),i()},tabIndex:0,role:"button",className:"whitespace-nowrap",children:e("switch_to",{theme:e("light"===t.theme?"dark":"light")})})}),a?(0,n.jsx)("li",{children:(0,n.jsx)(r(),{href:"/admin",onClick:()=>{var e,t;return null===(e=null===(t=document)||void 0===t?void 0:t.activeElement)||void 0===e?void 0:e.blur()},tabIndex:0,role:"button",className:"whitespace-nowrap",children:e("server_administration")})}):null,(0,n.jsx)("li",{children:(0,n.jsx)("div",{onClick:()=>{var e,t;null===(e=null===(t=document)||void 0===t?void 0:t.activeElement)||void 0===e||e.blur(),(0,A.signOut)()},tabIndex:0,role:"button",className:"whitespace-nowrap",children:e("logout")})})]})]})}function B(){let{t:e}=(0,b.$G)(),t=(0,o.useRouter)(),[l,i]=(0,s.useState)(!1),{width:r}=(0,_.Z)();(0,s.useEffect)(()=>{i(!1),document.body.style.overflow="auto"},[r,t]);let[d,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!1),[x,h]=(0,s.useState)(!1);return(0,n.jsxs)("div",{className:"flex justify-between gap-2 items-center pl-3 pr-4 py-2 border-solid border-b-neutral-content border-b",children:[(0,n.jsx)("div",{onClick:()=>{i(!0),document.body.style.overflow="hidden"},className:"text-neutral btn btn-square btn-sm btn-ghost lg:hidden sm:inline-flex",children:(0,n.jsx)("i",{className:"bi-list text-2xl leading-none"})}),(0,n.jsx)(I.Z,{}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(C.Z,{className:"hidden sm:inline-grid"}),(0,n.jsxs)("div",{className:"dropdown dropdown-end sm:inline-block hidden",children:[(0,n.jsx)("div",{className:"tooltip tooltip-bottom","data-tip":e("create_new"),children:(0,n.jsxs)("div",{tabIndex:0,role:"button",onMouseDown:M.Mm,className:"flex min-w-[3.4rem] items-center btn btn-accent dark:border-violet-400 text-white btn-sm max-h-[2rem] px-2 relative",children:[(0,n.jsx)("span",{children:(0,n.jsx)("i",{className:"bi-plus text-4xl absolute -top-[0.3rem] left-0 pointer-events-none"})}),(0,n.jsx)("span",{children:(0,n.jsx)("i",{className:"bi-caret-down-fill text-xs absolute top-2 right-[0.3rem] pointer-events-none"})})]})}),(0,n.jsxs)("ul",{className:"dropdown-content z-[1] menu shadow bg-base-200 border border-neutral-content rounded-box mt-1",children:[(0,n.jsx)("li",{children:(0,n.jsx)("div",{onClick:()=>{var e,t;null===(e=null===(t=document)||void 0===t?void 0:t.activeElement)||void 0===e||e.blur(),c(!0)},tabIndex:0,role:"button",className:"whitespace-nowrap",children:e("new_link")})}),(0,n.jsx)("li",{children:(0,n.jsx)("div",{onClick:()=>{var e,t;null===(e=null===(t=document)||void 0===t?void 0:t.activeElement)||void 0===e||e.blur(),h(!0)},tabIndex:0,role:"button",className:"whitespace-nowrap",children:e("upload_file")})}),(0,n.jsx)("li",{children:(0,n.jsx)("div",{onClick:()=>{var e,t;null===(e=null===(t=document)||void 0===t?void 0:t.activeElement)||void 0===e||e.blur(),m(!0)},tabIndex:0,role:"button",className:"whitespace-nowrap",children:e("new_collection")})})]})]}),(0,n.jsx)(T,{})]}),(0,n.jsx)(U,{}),l?(0,n.jsx)("div",{className:"fixed top-0 bottom-0 right-0 left-0 bg-black bg-opacity-10 backdrop-blur-sm flex items-center fade-in z-40",children:(0,n.jsx)(a.Z,{className:"h-full",onClickOutside:()=>{i(!1),document.body.style.overflow="auto"},children:(0,n.jsx)("div",{className:"slide-right h-full shadow-lg",children:(0,n.jsx)(k,{})})})}):null,d?(0,n.jsx)(E.Z,{onClose:()=>c(!1)}):void 0,u?(0,n.jsx)(S.Z,{onClose:()=>m(!1)}):void 0,x?(0,n.jsx)(G,{onClose:()=>h(!1)}):void 0]})}function L(e){let{toggleAnnouncementBar:t}=e,l=localStorage.getItem("announcementId");return(0,n.jsx)("div",{className:"fixed mx-auto bottom-20 sm:bottom-10 w-full pointer-events-none p-5 z-30",children:(0,n.jsxs)("div",{className:"mx-auto pointer-events-auto p-2 flex justify-between gap-2 items-center border border-primary shadow-xl rounded-xl bg-base-300 backdrop-blur-sm bg-opacity-80 max-w-md",children:[(0,n.jsx)("i",{className:"bi-stars text-2xl text-yellow-600 dark:text-yellow-500"}),(0,n.jsx)("p",{className:"w-4/5 text-center text-sm sm:text-base",children:(0,n.jsx)(b.cC,{i18nKey:"new_version_announcement",values:{version:l},components:[(0,n.jsx)(r(),{href:"https://blog.linkwarden.app/releases/".concat(l),target:"_blank",className:"underline"},0)]})}),(0,n.jsx)("button",{onClick:t,className:"btn btn-ghost btn-square btn-sm",children:(0,n.jsx)("i",{className:"bi-x text-xl"})})]})})}async function V(e){let t=localStorage.getItem("announcementId"),l=await fetch("https://blog.linkwarden.app/latest-announcement.json"),n=await l.json(),s=n.id;t!==s&&(e(!0),localStorage.setItem("announcementId",s))}function X(e){let{children:t}=e,l=localStorage.getItem("showAnnouncementBar"),[a,i]=(0,s.useState)(!l||"true"===l);return(0,s.useEffect)(()=>{V(i)},[]),(0,s.useEffect)(()=>{a?(localStorage.setItem("showAnnouncementBar","true"),i(!0)):a||(localStorage.setItem("showAnnouncementBar","false"),i(!1))},[a]),(0,n.jsxs)("div",{className:"flex","data-testid":"dashboard-wrapper",children:[a?(0,n.jsx)(L,{toggleAnnouncementBar:()=>{i(!a)}}):void 0,(0,n.jsx)("div",{className:"hidden lg:block",children:(0,n.jsx)(k,{className:"fixed top-0"})}),(0,n.jsxs)("div",{className:"w-full sm:pb-0 pb-20 flex flex-col min-h-screen lg:ml-80",children:[(0,n.jsx)(B,{}),t]})]})}}}]);