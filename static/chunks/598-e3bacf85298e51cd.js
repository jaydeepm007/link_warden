"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[598],{2144:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(5893),a=n(7294);function i(e){let t=0;for(;e;){let n=window.getComputedStyle(e).getPropertyValue("z-index"),r=Number(n);if("auto"!==n&&!isNaN(r)){t=r;break}e=e.parentElement}return t}function o(e){let{children:t,onClickOutside:n,className:o,style:s,onMount:l}=e,u=(0,a.useRef)(null);return(0,a.useEffect)(()=>{function e(e){let t=e.target;if(u.current&&!u.current.contains(t)){let r=i(u.current),a=i(t);a<=r&&n(e)}}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[u,n]),(0,a.useEffect)(()=>{if(u.current&&l){let e=u.current.getBoundingClientRect();l(e)}},[]),(0,r.jsx)("div",{ref:u,className:o,style:s,children:t})}},1810:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(5893),a=n(1163),i=n(7294),o=n(9760),s=n(4393),l=n(3157),u=n(7179);function c(e){let{onChange:t,defaultValue:n,showDefaultValue:c=!0,creatable:d=!0}=e,{data:p=[]}=(0,u.bX)(),y=(0,a.useRouter)(),[f,m]=(0,i.useState)([]),h=Number(y.query.id),v=p.find(e=>e.id===h);v&&!n&&(n={value:null==v?void 0:v.id,label:null==v?void 0:v.name}),(0,i.useEffect)(()=>{let e=p.map(e=>({value:e.id,label:e.name,ownerId:e.ownerId,count:e._count,parentId:e.parentId}));m(e)},[p]);let b=e=>{let t=[],n=p.find(t=>t.id===e);return n&&(t.push(n.name),n.parentId&&t.push(...b(n.parentId))),t.reverse()},g=e=>{var t;let{data:n,innerProps:a}=e;return(0,r.jsxs)("div",{...a,className:"px-2 py-2 last:border-0 border-b border-neutral-content hover:bg-neutral-content cursor-pointer",children:[(0,r.jsxs)("div",{className:"flex w-full justify-between items-center",children:[(0,r.jsx)("span",{children:n.label}),(0,r.jsx)("span",{className:"text-sm text-neutral",children:null===(t=n.count)||void 0===t?void 0:t.links})]}),(0,r.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-300",children:b(null==n?void 0:n.parentId).length>0?(0,r.jsxs)(r.Fragment,{children:[b(n.parentId).join(" > ")," ",">"," ",n.label]}):n.label})]})};return d?(0,r.jsx)(s.Z,{isClearable:!1,className:"react-select-container",classNamePrefix:"react-select",onChange:t,options:f,styles:o.W,defaultValue:c?n:null,components:{Option:g}}):(0,r.jsx)(l.ZP,{isClearable:!1,className:"react-select-container",classNamePrefix:"react-select",onChange:t,options:f,styles:o.W,defaultValue:c?n:null,components:{Option:g}})}},2122:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(5893),a=n(7294),i=n(4393),o=n(9760),s=n(4806);function l(e){let{onChange:t,defaultValue:n}=e,{data:l=[]}=(0,s.e0)(),[u,c]=(0,a.useState)([]);return(0,a.useEffect)(()=>{let e=l.map(e=>({value:e.id,label:e.name}));c(e)},[l]),(0,r.jsx)(i.Z,{isClearable:!1,className:"react-select-container",classNamePrefix:"react-select",onChange:t,options:u,styles:o.W,defaultValue:n,isMulti:!0})}},9760:function(e,t,n){n.d(t,{W:function(){return a}});let r="ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji",a={option:(e,t)=>({...e,fontFamily:r,cursor:"pointer",backgroundColor:t.isSelected?"oklch(var(--p))":"inherit","&:hover":{backgroundColor:t.isSelected?"oklch(var(--p))":"oklch(var(--nc))"},transition:"all 50ms"}),control:(e,t)=>({...e,fontFamily:r,borderRadius:"0.375rem",border:t.isFocused?"1px solid oklch(var(--p))":"1px solid oklch(var(--nc))",boxShadow:"none",minHeight:"2.6rem"}),container:(e,t)=>({...e,height:"full",borderRadius:"0.375rem",lineHeight:"1.25rem"}),input:e=>({...e,cursor:"text"}),dropdownIndicator:e=>({...e,cursor:"pointer"}),placeholder:e=>({...e,borderColor:"black"}),multiValue:e=>({...e,backgroundColor:"#0ea5e9",color:"white"}),multiValueLabel:e=>({...e,color:"white"}),multiValueRemove:e=>({...e,":hover":{color:"white",backgroundColor:"#38bdf8"}}),menuPortal:e=>({...e,zIndex:9999})}},7169:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(5893),a=n(7294),i=n(2144),o=n(2314);function s(e){let{toggleModal:t,className:n,children:s,dismissible:l=!0}=e,[u,c]=a.useState(!0);return((0,a.useEffect)(()=>{if(window.innerWidth>=640)return document.body.style.overflow="hidden",document.body.style.position="relative",()=>{document.body.style.overflow="auto",document.body.style.position=""}},[]),window.innerWidth<640)?(0,r.jsx)(o.d.Root,{open:u,onClose:()=>l&&setTimeout(()=>t(),100),dismissible:l,children:(0,r.jsxs)(o.d.Portal,{children:[(0,r.jsx)(o.d.Overlay,{className:"fixed inset-0 bg-black/40"}),(0,r.jsx)(i.Z,{onClickOutside:()=>l&&c(!1),children:(0,r.jsx)(o.d.Content,{className:"flex flex-col rounded-t-2xl min-h-max mt-24 fixed bottom-0 left-0 right-0 z-30",children:(0,r.jsxs)("div",{className:"p-4 bg-base-100 rounded-t-2xl flex-1 border-neutral-content border-t overflow-y-auto","data-testid":"mobile-modal-container",children:[(0,r.jsx)("div",{className:"mx-auto w-12 h-1.5 flex-shrink-0 rounded-full bg-neutral mb-5","data-testid":"mobile-modal-slider"}),s]})})})]})}):(0,r.jsx)("div",{className:"overflow-y-auto pt-2 sm:py-2 fixed top-0 bottom-0 right-0 left-0 bg-black bg-opacity-10 backdrop-blur-sm flex justify-center items-center fade-in z-40","data-testid":"modal-outer",children:(0,r.jsx)(i.Z,{onClickOutside:()=>l&&t(),className:"w-full mt-auto sm:m-auto sm:w-11/12 sm:max-w-2xl ".concat(n||""),children:(0,r.jsxs)("div",{className:"slide-up mt-auto sm:m-auto relative border-neutral-content rounded-t-2xl sm:rounded-2xl border-t sm:border shadow-2xl p-5 bg-base-100 overflow-y-auto sm:overflow-y-visible","data-testid":"modal-container",children:[l&&(0,r.jsx)("div",{onClick:t,className:"absolute top-4 right-3 btn btn-sm outline-none btn-circle btn-ghost z-10",children:(0,r.jsx)("i",{className:"bi-x text-neutral text-2xl","data-testid":"close-modal-button"})}),s]})})})}},4157:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(5893);function a(e){let{autoFocus:t,value:n,type:a,placeholder:i,onChange:o,onKeyDown:s,className:l,spellCheck:u,"data-testid":c}=e;return(0,r.jsx)("input",{"data-testid":c,spellCheck:u,autoFocus:t,type:a||"text",placeholder:i,value:n,onChange:o,onKeyDown:s,className:"w-full rounded-md p-2 border-neutral-content border-solid border outline-none focus:border-primary duration-100 ".concat(l||"")})}},7199:function(e,t,n){var r=n(5893),a=n(8229),i=n(5139);let o=(0,i.j)("select-none relative duration-200 rounded-lg text-center w-fit flex justify-center items-center gap-2 disabled:pointer-events-none disabled:opacity-50",{variants:{intent:{accent:"bg-accent text-white hover:bg-accent/80 border border-violet-400",primary:"bg-primary text-primary-content hover:bg-primary/80",secondary:"bg-neutral-content text-secondary-foreground hover:bg-neutral-content/80 border border-neutral/30",destructive:"bg-error text-white hover:bg-error/80 border border-neutral/60",outline:"border border-input bg-background hover:bg-accent hover:text-accent-content",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{small:"h-7 px-2",medium:"h-10 px-4 py-2",large:"h-12 px-7 py-2",full:"px-4 py-2 w-full",icon:"h-10 w-10"},loading:{true:"cursor-wait"}},defaultVariants:{intent:"primary",size:"medium"}});t.Z=e=>{let{className:t,intent:n,size:i,children:s,disabled:l,loading:u=!1,...c}=e;return(0,r.jsx)("button",{className:(0,a.cn)(o({intent:n,size:i,className:t})),disabled:u||l,...c,children:s})}},7179:function(e,t,n){n.d(t,{$J:function(){return l},Do:function(){return c},bX:function(){return s},vU:function(){return u}});var r=n(8551),a=n(202),i=n(8029),o=n(3299);let s=()=>{let{status:e}=(0,o.useSession)();return(0,r.a)({queryKey:["collections"],queryFn:async()=>{let e=await fetch("/api/v1/collections"),t=await e.json();return t.response},enabled:"authenticated"===e})},l=()=>{let e=(0,a.NL)();return(0,i.D)({mutationFn:async e=>{let t=await fetch("/api/v1/collections",{body:JSON.stringify(e),headers:{"Content-Type":"application/json"},method:"POST"}),n=await t.json();if(!t.ok)throw Error(n.response);return n.response},onSuccess:t=>e.setQueryData(["collections"],e=>[...e,t])})},u=()=>{let e=(0,a.NL)();return(0,i.D)({mutationFn:async e=>{let t=await fetch("/api/v1/collections/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await t.json();if(!t.ok)throw Error(n.response);return n.response},onSuccess:t=>e.setQueryData(["collections"],e=>e.map(e=>e.id===t.id?t:e))})},c=()=>{let e=(0,a.NL)();return(0,i.D)({mutationFn:async e=>{let t=await fetch("/api/v1/collections/".concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"}}),n=await t.json();if(!t.ok)throw Error(n.response);return n.response},onSuccess:t=>e.setQueryData(["collections"],e=>e.filter(e=>e.id!==t.id))})}},6496:function(e,t,n){n.d(t,{Mj:function(){return y},S5:function(){return m},Sw:function(){return w},Yc:function(){return f},Yi:function(){return g},kR:function(){return b},mk:function(){return h},tD:function(){return v},u8:function(){return c}});var r=n(9726),a=n(202),i=n(8029),o=n(7294),s=n(7102),l=n(1163),u=n(3299);let c=function(){var e,t,n,r,a;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,l.useRouter)(),u={sort:null!==(t=null!==(e=i.sort)&&void 0!==e?e:Number(window.localStorage.getItem("sortBy")))&&void 0!==t?t:0,collectionId:(null!==(n=i.collectionId)&&void 0!==n?n:"/collections/[id]"===s.pathname)?s.query.id:void 0,tagId:(null!==(r=i.tagId)&&void 0!==r?r:"/tags/[id]"===s.pathname)?s.query.id:void 0,pinnedOnly:(null!==(a=i.pinnedOnly)&&void 0!==a?!!a:"/links/pinned"===s.pathname)||void 0,searchQueryString:i.searchQueryString,searchByName:i.searchByName,searchByUrl:i.searchByUrl,searchByDescription:i.searchByDescription,searchByTextContent:i.searchByTextContent,searchByTags:i.searchByTags},c=p(u),{data:y,...f}=d(c),m=(0,o.useMemo)(()=>null==y?void 0:y.pages.reduce((e,t)=>[...e,...t],[]),[y]);return{links:m,data:{...y,...f}}},d=e=>{let{status:t}=(0,u.useSession)();return(0,r.N)({queryKey:["links",{params:e}],queryFn:async e=>{let t=await fetch("/api/v1/links?cursor="+e.pageParam+(e.queryKey[1].params?"&"+e.queryKey[1].params:"")),n=await t.json();return n.response},initialPageParam:0,refetchOnWindowFocus:!1,getNextPageParam:e=>{if(0!==e.length)return e.at(-1).id},enabled:"authenticated"===t})},p=e=>Object.keys(e).filter(t=>void 0!==e[t]).map(t=>"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t]))).join("&"),y=()=>{let e=(0,a.NL)();return(0,i.D)({mutationFn:async e=>{let t=await fetch("/api/v1/links",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await t.json();if(!t.ok)throw Error(n.response);return n.response},onSuccess:t=>{e.setQueryData(["dashboardData"],e=>{if(e)return[t,...e]}),e.setQueriesData({queryKey:["links"]},e=>{if(e)return{pages:[[t,...null==e?void 0:e.pages[0]],...null==e?void 0:e.pages.slice(1)],pageParams:null==e?void 0:e.pageParams}}),e.invalidateQueries({queryKey:["collections"]}),e.invalidateQueries({queryKey:["tags"]}),e.invalidateQueries({queryKey:["publicLinks"]})}})},f=()=>{let e=(0,a.NL)();return(0,i.D)({mutationFn:async e=>{let t=await fetch("/api/v1/links/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await t.json();if(!t.ok)throw Error(n.response);return n.response},onSuccess:t=>{e.invalidateQueries({queryKey:["links"]}),e.invalidateQueries({queryKey:["dashboardData"]}),e.invalidateQueries({queryKey:["collections"]}),e.invalidateQueries({queryKey:["tags"]}),e.invalidateQueries({queryKey:["publicLinks"]})}})},m=()=>{let e=(0,a.NL)();return(0,i.D)({mutationFn:async e=>{let t=await fetch("/api/v1/links/".concat(e),{method:"DELETE"}),n=await t.json();if(!t.ok)throw Error(n.response);return n.response},onSuccess:t=>{e.setQueryData(["dashboardData"],e=>{if(e)return e.filter(e=>e.id!==t.id)}),e.setQueriesData({queryKey:["links"]},e=>{if(e)return{pages:e.pages.map(e=>e.filter(e=>e.id!==t.id)),pageParams:e.pageParams}}),e.invalidateQueries({queryKey:["collections"]}),e.invalidateQueries({queryKey:["tags"]}),e.invalidateQueries({queryKey:["publicLinks"]})}})},h=()=>{let e=(0,a.NL)();return(0,i.D)({mutationFn:async e=>{let t=await fetch("/api/v1/links/".concat(e)),n=await t.json();if(!t.ok)throw Error(n.response);return n.response},onSuccess:t=>{e.setQueryData(["dashboardData"],e=>{if(e)return e.map(e=>e.id===t.id?t:e)}),e.setQueriesData({queryKey:["links"]},e=>{if(e)return{pages:e.pages.map(e=>e.map(e=>e.id===t.id?t:e)),pageParams:e.pageParams}}),e.invalidateQueries({queryKey:["publicLinks"]})}})},v=()=>{let e=(0,a.NL)();return(0,i.D)({mutationFn:async e=>{let t=await fetch("/api/v1/links",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({linkIds:e})}),n=await t.json();if(!t.ok)throw Error(n.response);return e},onSuccess:t=>{e.setQueryData(["dashboardData"],e=>{if(e)return e.filter(e=>!t.includes(e.id))}),e.setQueriesData({queryKey:["links"]},e=>{if(e)return{pages:e.pages.map(e=>e.filter(e=>!t.includes(e.id))),pageParams:e.pageParams}}),e.invalidateQueries({queryKey:["collections"]}),e.invalidateQueries({queryKey:["tags"]}),e.invalidateQueries({queryKey:["publicLinks"]})}})},b=()=>{let e=(0,a.NL)();return(0,i.D)({mutationFn:async e=>{let{link:t,file:n}=e,r=null,a=null;if((null==n?void 0:n.type)==="image/jpg"||"image/jpeg"===n.type)r=s.Gt.jpeg,a="image";else if("image/png"===n.type)r=s.Gt.png,a="image";else{if("application/pdf"!==n.type)return{ok:!1,data:"Invalid file type."};r=s.Gt.pdf,a="pdf"}let i=await fetch("/api/v1/links",{body:JSON.stringify({...t,type:a,name:t.name?t.name:n.name}),headers:{"Content-Type":"application/json"},method:"POST"}),o=await i.json();if(!i.ok)throw Error(o.response);if(i.ok){let e=new FormData;n&&e.append("file",n),await fetch("/api/v1/archives/".concat(o.response.id,"?format=").concat(r),{body:e,method:"POST"})}return o.response},onSuccess:t=>{e.setQueryData(["dashboardData"],e=>{if(e)return[t,...e]}),e.setQueriesData({queryKey:["links"]},e=>{if(e)return{pages:[[t,...null==e?void 0:e.pages[0]],...null==e?void 0:e.pages.slice(1)],pageParams:null==e?void 0:e.pageParams}}),e.invalidateQueries({queryKey:["collections"]}),e.invalidateQueries({queryKey:["tags"]}),e.invalidateQueries({queryKey:["publicLinks"]})}})},g=()=>{let e=(0,a.NL)();return(0,i.D)({mutationFn:async e=>{let{links:t,newData:n,removePreviousTags:r}=e,a=await fetch("/api/v1/links",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({links:t,newData:n,removePreviousTags:r})}),i=await a.json();if(!a.ok)throw Error(i.response);return i.response},onSuccess:(t,n)=>{let{links:r,newData:a,removePreviousTags:i}=n;e.invalidateQueries({queryKey:["links"]}),e.invalidateQueries({queryKey:["dashboardData"]}),e.invalidateQueries({queryKey:["collections"]}),e.invalidateQueries({queryKey:["tags"]}),e.invalidateQueries({queryKey:["publicLinks"]})}})},w=async(e,t)=>{e.setQueriesData({queryKey:t},e=>{if(e)return{pages:e.pages.slice(0,1),pageParams:e.pageParams.slice(0,1)}}),await e.invalidateQueries(t)}},4806:function(e,t,n){n.d(t,{e0:function(){return s},nY:function(){return u},yi:function(){return l}});var r=n(8551),a=n(202),i=n(8029),o=n(3299);let s=()=>{let{status:e}=(0,o.useSession)();return(0,r.a)({queryKey:["tags"],queryFn:async()=>{let e=await fetch("/api/v1/tags");if(!e.ok)throw Error("Failed to fetch tags.");let t=await e.json();return t.response},enabled:"authenticated"===e})},l=()=>{let e=(0,a.NL)();return(0,i.D)({mutationFn:async e=>{let t=await fetch("/api/v1/tags/".concat(e.id),{body:JSON.stringify(e),headers:{"Content-Type":"application/json"},method:"PUT"}),n=await t.json();if(!t.ok)throw Error(n.response);return n.response},onSuccess:t=>{e.setQueryData(["tags"],e=>e.map(e=>e.id===t.id?t:e))}})},u=()=>{let e=(0,a.NL)();return(0,i.D)({mutationFn:async e=>{let t=await fetch("/api/v1/tags/".concat(e),{method:"DELETE"}),n=await t.json();if(!t.ok)throw Error(n.response);return n.response},onSuccess:(t,n)=>{e.setQueryData(["tags"],e=>e.filter(e=>e.id!==n))}})}},2980:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(7294),a=n(7179),i=n(2676);function o(e){let{data:t=[]}=(0,a.bX)(),{data:n={}}=(0,i.a)(),[o,s]=(0,r.useState)();return(0,r.useEffect)(()=>{let r=t.find(t=>t.id===e);if(r){var a,i,o;let e=r.members.find(e=>e.userId===n.id);(null===(a=e)||void 0===a?void 0:a.canCreate)===!1&&(null===(i=e)||void 0===i?void 0:i.canUpdate)===!1&&(null===(o=e)||void 0===o?void 0:o.canDelete)===!1&&(e=void 0),s(n.id===r.ownerId||e)}},[n,t,e]),o}},1256:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(6501);async function a(e){let t=await fetch("/api/v1/public/users/".concat(e)),n=await t.json();return t.ok||r.Am.error(n.response),n.response}},9401:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e){return new DOMParser().parseFromString(e,"text/html").documentElement.textContent}}}]);