"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[128],{4128:function(e,s,a){a.d(s,{Z:function(){return p}});var r=a(5893),n=a(7294),t=a(4157),l=a(6501),c=a(1256),i=a(2980),d=a(5130);let o=async(e,s,a,r,n)=>{let t=a.members.find(e=>{let a=(e.user.username||"").toLowerCase();return a===s.toLowerCase()});if(t||""===s.trim()||s.trim().toLowerCase()===e.toLowerCase())t?l.Am.error(n("user_already_member")):s.trim().toLowerCase()===e.toLowerCase()&&l.Am.error(n("you_are_already_collection_owner"));else{let e=await (0,c.Z)(s.trim().toLowerCase());e.username&&r({collectionId:a.id,canCreate:!1,canUpdate:!1,canDelete:!1,userId:e.id,user:{id:e.id,name:e.name,username:e.username,image:e.image}})}};var m=a(7169),u=a(8229),x=a(8276),b=a(7179),h=a(2676);function p(e){var s;let{onClose:a,activeCollection:p}=e,{t:v}=(0,x.$G)(),[j,w]=(0,n.useState)(p),[N,f]=(0,n.useState)(!1),g=(0,b.vU)(),y=async()=>{if(!N){if(f(!0),!j)return null;f(!0);let e=l.ZP.loading(v("updating_collection"));await g.mutateAsync(j,{onSettled:(s,r)=>{l.ZP.dismiss(e),r?l.ZP.error(r.message):(a(),l.ZP.success(v("updated")))}}),f(!1)}},{data:k={}}=(0,h.a)(),_=(0,i.Z)(j.id),C=new URL(document.URL),I="".concat(C.origin,"/public/collections/").concat(j.id),[D,U]=(0,n.useState)(""),[Z,P]=(0,n.useState)({id:null,name:"",username:"",image:"",archiveAsScreenshot:void 0,archiveAsMonolith:void 0,archiveAsPDF:void 0});(0,n.useEffect)(()=>{let e=async()=>{let e=await (0,c.Z)(j.ownerId);P(e)};e(),w(p)},[]);let L=e=>{if(!j)return null;w({...j,members:[...j.members,e]}),U("")};return(0,r.jsxs)(m.Z,{toggleModal:a,children:[(0,r.jsx)("p",{className:"text-xl font-thin",children:!0===_?v("share_and_collaborate"):v("team")}),(0,r.jsx)("div",{className:"divider mb-3 mt-1"}),(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[!0===_&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:v("make_collection_public")}),(0,r.jsxs)("label",{className:"label cursor-pointer justify-start gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:j.isPublic,onChange:()=>w({...j,isPublic:!j.isPublic}),className:"checkbox checkbox-primary"}),(0,r.jsx)("span",{className:"label-text",children:v("make_collection_public_checkbox")})]}),(0,r.jsx)("p",{className:"text-neutral text-sm",children:v("make_collection_public_desc")})]}),j.isPublic?(0,r.jsxs)("div",{className:!0===_?"pl-5":"",children:[(0,r.jsx)("p",{className:"mb-2",children:v("sharable_link_guide")}),(0,r.jsx)("div",{onClick:()=>{try{navigator.clipboard.writeText(I).then(()=>l.ZP.success(v("copied")))}catch(e){console.log(e)}},className:"w-full hide-scrollbar overflow-x-auto whitespace-nowrap rounded-md p-2 bg-base-200 border-neutral-content border-solid border outline-none hover:border-primary dark:hover:border-primary duration-100 cursor-text",children:I})]}):null,!0===_&&(0,r.jsx)("div",{className:"divider my-3"}),!0===_&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{children:v("members")}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(t.Z,{value:D||"",className:"bg-base-200",placeholder:v("members_username_placeholder"),onChange:e=>U(e.target.value),onKeyDown:e=>"Enter"===e.key&&o(k.username,D||"",j,L,v)}),(0,r.jsx)("div",{onClick:()=>o(k.username,D||"",j,L,v),className:"btn btn-accent dark:border-violet-400 text-white btn-square btn-sm h-10 w-10",children:(0,r.jsx)("i",{className:"bi-person-add text-xl"})})]})]}),(null==j?void 0:null===(s=j.members[0])||void 0===s?void 0:s.user)&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex flex-col divide-y divide-neutral-content border border-neutral-content rounded-xl bg-base-200",children:[(0,r.jsx)("div",{className:"relative p-3 bg-base-200 rounded-xl flex gap-2 justify-between",title:"@".concat(Z.username," is the owner of this collection"),children:(0,r.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"shrink-0",children:(0,r.jsx)(d.Z,{src:Z.image?Z.image:void 0,name:Z.name})}),(0,r.jsxs)("div",{className:"grow ml-2",children:[(0,r.jsx)("p",{className:"text-sm font-semibold",children:Z.name}),(0,r.jsxs)("p",{className:"text-xs text-neutral",children:["@",Z.username]})]})]}),(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-sm font-bold",children:v("owner")})})]})}),(0,r.jsx)("div",{className:"divider my-0 last:hidden h-[3px]"}),j.members.sort((e,s)=>e.userId-s.userId).map((e,s)=>{let a=e.canCreate&&e.canUpdate&&e.canDelete?v("admin"):!e.canCreate||e.canUpdate||e.canDelete?e.canCreate||e.canUpdate||e.canDelete?void 0:v("viewer"):v("contributor");return(0,r.jsxs)(n.Fragment,{children:[(0,r.jsx)("div",{className:"relative p-3 bg-base-200 rounded-xl flex gap-2 justify-between border-none",children:(0,r.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"shrink-0",children:(0,r.jsx)(d.Z,{src:e.user.image?e.user.image:void 0,name:e.user.name})}),(0,r.jsxs)("div",{className:"grow ml-2",children:[(0,r.jsx)("p",{className:"text-sm font-semibold",children:e.user.name}),(0,r.jsxs)("p",{className:"text-xs text-neutral",children:["@",e.user.username]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[!0===_?(0,r.jsxs)("div",{className:"dropdown dropdown-bottom dropdown-end",children:[(0,r.jsxs)("div",{tabIndex:0,role:"button",onMouseDown:u.Mm,className:"btn btn-sm btn-primary font-normal",children:[a,(0,r.jsx)("i",{className:"bi-chevron-down"})]}),(0,r.jsxs)("ul",{className:"dropdown-content z-[30] menu shadow bg-base-200 border border-neutral-content rounded-xl mt-1",children:[(0,r.jsx)("li",{children:(0,r.jsxs)("label",{className:"label cursor-pointer flex justify-start",tabIndex:0,role:"button",children:[(0,r.jsx)("input",{type:"radio",name:"role-radio-".concat(e.userId),className:"radio checked:bg-primary",checked:!e.canCreate&&!e.canUpdate&&!e.canDelete,onChange:()=>{var s,a;let r={...e,canCreate:!1,canUpdate:!1,canDelete:!1},n=j.members.map(s=>s.userId===e.userId?r:s);w({...j,members:n}),null===(s=null===(a=document)||void 0===a?void 0:a.activeElement)||void 0===s||s.blur()}}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold whitespace-nowrap",children:v("viewer")}),(0,r.jsx)("p",{className:"whitespace-nowrap",children:v("viewer_desc")})]})]})}),(0,r.jsx)("li",{children:(0,r.jsxs)("label",{className:"label cursor-pointer flex justify-start",tabIndex:0,role:"button",children:[(0,r.jsx)("input",{type:"radio",name:"role-radio-".concat(e.userId),className:"radio checked:bg-primary",checked:e.canCreate&&!e.canUpdate&&!e.canDelete,onChange:()=>{var s,a;let r={...e,canCreate:!0,canUpdate:!1,canDelete:!1},n=j.members.map(s=>s.userId===e.userId?r:s);w({...j,members:n}),null===(s=null===(a=document)||void 0===a?void 0:a.activeElement)||void 0===s||s.blur()}}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold whitespace-nowrap",children:v("contributor")}),(0,r.jsx)("p",{className:"whitespace-nowrap",children:v("contributor_desc")})]})]})}),(0,r.jsx)("li",{children:(0,r.jsxs)("label",{className:"label cursor-pointer flex justify-start",tabIndex:0,role:"button",children:[(0,r.jsx)("input",{type:"radio",name:"role-radio-".concat(e.userId),className:"radio checked:bg-primary",checked:e.canCreate&&e.canUpdate&&e.canDelete,onChange:()=>{var s,a;let r={...e,canCreate:!0,canUpdate:!0,canDelete:!0},n=j.members.map(s=>s.userId===e.userId?r:s);w({...j,members:n}),null===(s=null===(a=document)||void 0===a?void 0:a.activeElement)||void 0===s||s.blur()}}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold whitespace-nowrap",children:v("admin")}),(0,r.jsx)("p",{className:"whitespace-nowrap",children:v("admin_desc")})]})]})})]})]}):(0,r.jsx)("p",{className:"text-sm text-neutral",children:a}),!0===_&&(0,r.jsx)("i",{className:"bi-x text-xl btn btn-sm btn-square btn-ghost text-neutral hover:text-red-500 dark:hover:text-red-500 duration-100 cursor-pointer",title:v("remove_member"),onClick:()=>{let s=j.members.filter(s=>s.user.username!==e.user.username);w({...j,members:s})}})]})]})}),(0,r.jsx)("div",{className:"divider my-0 last:hidden h-[3px]"})]},s)})]})}),!0===_&&(0,r.jsx)("button",{className:"btn btn-accent dark:border-violet-400 text-white w-fit ml-auto mt-3",onClick:y,children:v("save_changes")})]})]})}}}]);